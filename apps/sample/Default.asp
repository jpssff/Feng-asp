<%@LANGUAGE="JavaScript" CODEPAGE="65001"%>
<%
var START=new Date().getTime();var DEBUG_MODE=true;if(!Object.keys){Object.keys=function(o){if(o!==Object(o))
throw new Error('Object.keys called on non-object');var ret=[],p;for(p in o)if(Object.prototype.hasOwnProperty.call(o,p))ret.push(p);return ret;}}
if(!Function.prototype.bind){Function.prototype.bind=function(obj){var slice=[].slice,args=slice.call(arguments,1),self=this,nop=function(){},bound=function(){return self.apply(this instanceof nop?this:(obj||{}),args.concat(slice.call(arguments)));};nop.prototype=self.prototype;bound.prototype=new nop();return bound;};}
if(!Array.prototype.every){Array.prototype.every=function(fun){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(typeof fun!=="function")
throw new Error();var thisp=arguments[1];for(var i=0;i<len;i++){if(i in t&&!fun.call(thisp,t[i],i,t))
return false;}
return true;};}
if(!Array.prototype.filter){Array.prototype.filter=function(fun){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(typeof fun!=="function")
throw new Error();var res=[];var thisp=arguments[1];for(var i=0;i<len;i++){if(i in t){var val=t[i];if(fun.call(thisp,val,i,t))
res.push(val);}}
return res;};}
if(!Array.prototype.forEach){Array.prototype.forEach=function(fun){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(typeof fun!=="function")
throw new Error();var thisp=arguments[1];for(var i=0;i<len;i++){if(i in t)
fun.call(thisp,t[i],i,t);}};}
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(searchElement){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(len===0)
return-1;var n=0;if(arguments.length>0){n=Number(arguments[1]);if(n!==n)
n=0;else if(n!==0&&n!==(Infinity)&&n!==-(Infinity))
n=(n>0||-1)*Math.floor(Math.abs(n));}
if(n>=len)
return-1;var k=n>=0?n:Math.max(len-Math.abs(n),0);for(;k<len;k++){if(k in t&&t[k]===searchElement)
return k;}
return-1;};}
Array.isArray=Array.isArray||function(o){return Object.prototype.toString.call(o)==='[object Array]';};if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(searchElement){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(len===0)
return-1;var n=len;if(arguments.length>1){n=Number(arguments[1]);if(n!==n)
n=0;else if(n!==0&&n!==(Infinity)&&n!==-(Infinity))
n=(n>0||-1)*Math.floor(Math.abs(n));}
var k=n>=0?Math.min(n,len-1):len-Math.abs(n);for(;k>=0;k--){if(k in t&&t[k]===searchElement)
return k;}
return-1;};}
if(!Array.prototype.map){Array.prototype.map=function(fun){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(typeof fun!=="function")
throw new Error();var res=new Array(len);var thisp=arguments[1];for(var i=0;i<len;i++){if(i in t)
res[i]=fun.call(thisp,t[i],i,t);}
return res;};}
if(!Array.prototype.reduce){Array.prototype.reduce=function(fun){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(typeof fun!=="function")
throw new Error();if(len==0&&arguments.length==1)
throw new Error();var k=0;var accumulator;if(arguments.length>=2){accumulator=arguments[1];}else{do{if(k in t){accumulator=t[k++];break;}
if(++k>=len)
throw new Error();}
while(true);}
while(k<len){if(k in t)
accumulator=fun.call(undefined,accumulator,t[k],k,t);k++;}
return accumulator;};}
if(!Array.prototype.reduceRight){Array.prototype.reduceRight=function(callbackfn){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(typeof callbackfn!=="function")
throw new Error();if(len===0&&arguments.length===1)
throw new Error();var k=len-1;var accumulator;if(arguments.length>=2){accumulator=arguments[1];}else{do{if(k in this){accumulator=this[k--];break;}
if(--k<0)
throw new Error();}
while(true);}
while(k>=0){if(k in t)
accumulator=callbackfn.call(undefined,accumulator,t[k],k,t);k--;}
return accumulator;};}
if(!Array.prototype.some){Array.prototype.some=function(fun){"use strict";if(this===void 0||this===null)
throw new Error();var t=Object(this);var len=t.length>>>0;if(typeof fun!=="function")
throw new Error();var thisp=arguments[1];for(var i=0;i<len;i++){if(i in t&&fun.call(thisp,t[i],i,t))
return true;}
return false;};}
if(!Date.now){Date.now=function now(){return+new Date();};}
if(!String.prototype.trim){String.prototype.trim=(function(){var trimLeft=/^\s+/,trimRight=/\s+$/;return function(){return this.replace(trimLeft,"").replace(trimRight,"");}})()};String.prototype.nl2br=function(){return this.replace(/\n/g,'<br>');};var F={version:20110520};F.getGuid=function(){var _id=1;F.getGuid=function(){_id++;return _id;};return _id;};F._included={};F.namespace=function(name){var ns=name.split('.'),nt=ns.shift(),is_f=nt=='F'||nt=='feng',cur=F,part;if(is_f){F._included[name]=true;}
while(ns.length&&(part=ns.shift())){if(!cur[part]){cur[part]={};}
cur=cur[part];}};F.require=function(name){if(!F._included[name]){}};F.inherits=function(fn,parentFn){function tempFn(){};tempFn.prototype=parentFn.prototype;fn._superClass=parentFn.prototype;fn.prototype=new tempFn();fn.prototype.constructor=fn;};F.isArray=function(arg){return arg instanceof Array||'[object Array]'===Object.prototype.toString.call(arg);}
F.isObject=function(arg){return'object'===typeof arg||'function'===typeof arg;}
F.isFunction=function(arg){return'[object Function]'===Object.prototype.toString.call(arg);}
F.isNumber=function(arg){return'[object Number]'===Object.prototype.toString.call(arg);}
F.isString=function(arg){return'[object String]'===Object.prototype.toString.call(arg);}
F.isBoolen=function(arg){return'boolen'===typeof arg;}
F.isUndefinded=function(arg,u){return arg===u;};F.extend=function(obj_desc,obj_source){for(var fn in obj_source){obj_desc[fn]=obj_source[fn];}
return obj_desc;};F.addMethods=function(obj_methods){F.extend(F,obj_methods);};F.desc=function(){function desc(json,pre){var html=['<ul class="F_DESC">'];for(var i in json){var key=pre+'.'+(i.indexOf('.')!==-1?'&lt;'+i+'&gt;':i);html.push('<li><b>'+key+'</b><span>'+
(typeof(json[i])==='function'?json[i].toString().match(/function\s*\([^)]*?\)/)||'function(...)':typeof json[i])+'</span></li>');if(typeof json[i]==='object'&&json[i]!==this){html.push(desc(json[i],key));}else if(typeof json[i]==='function'){html.push(desc(json[i].prototype,key+'.prototype'));}}
html.push('</ul>');return html.join('');}
var style='<style>.F_DESC b{font:14px/18px Consolas,Monaco,"Courier New"}'+'.F_DESC span{color:#0BAD03;font-size:13px;margin-left:10px;}</style>';var html=[];Array.prototype.forEach.call(arguments,function(v,i){html.push(desc(v[0],v[1]));});return style+html.join('');};F.get=function(key){if(key===undefined){var r={},s=new Enumerator(Request.QueryString);for(;!s.atEnd();s.moveNext()){var x=s.item();r[x]=Request.QueryString(x).Item;}
return r;}else{return Request.QueryString(key).Item;}};F.post=function(key){if(key===undefined){var r={},s=new Enumerator(Request.Form);for(;!s.atEnd();s.moveNext()){var x=s.item();r[x]=Request.Form(x).Item;}
return r;}else{return Request.Form(key).Item;}};F.server=function(key){if(key===undefined){var r={},s=new Enumerator(Request.ServerVariables);for(;!s.atEnd();s.moveNext()){var x=s.item();r[x]=Request.ServerVariables(x).Item;}
return r;}else{return Request.ServerVariables(key).Item;}};F.isGet=function(){return F.server("REQUEST_METHOD").toLowerCase()==='get';};F.isPost=function(){return F.server("REQUEST_METHOD").toLowerCase()==='post';};F.isAjax=function(){return F.server('HTTP_X_REQUESTED_WITH')==='XMLHttpRequest';};F.ip=function(){var proxy=F.server("HTTP_X_FORWARDED_FOR"),ip=proxy&&proxy.indexOf("unknown")!=-1?proxy.split(/,;/g)[0]:F.server("REMOTE_ADDR");ip=ip.trim().substring(0,15);return"::1"===ip?"127.0.0.1":ip;};F.guid=function(){var scriptletTypelib=new ActiveXObject("Scriptlet.Typelib");var value=scriptletTypelib.Guid.substring(0,38);scriptletTypelib=null;return value;};F.encodeHTML=function(text){return String(text).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,"&quot;").replace(/'/g,"&#39;");};F.go=function(url){Response.Redirect(url);};F.header=function(key,value){Response.AddHeader(key,value);};F.url=function(){var port=F.server('SERVER_PORT');var server=F.server('SERVER_NAME');var url=F.server('URL'),query=F.server('QUERY_STRING');return(port=='443'?'https://':'http://')+server+
((port=="80"||port=="443")?"":":"+port)+url+(query===''?'':'?'+query);};F.execute=function(path){var js=new F.File(path).getText();try{return(new Function(js))();}catch(e){e.path=path;e.js=js;debug(arguments,e);}};(function(){var BS=(function(bs){function BS(selector,content){bs.push([])
return BS2(selector,content)}
function BS2(selector,content){content=''+(content||'')
selector&&write('<',selector,'>')
content&&write(content)
selector&&write('</',selector.split(' ')[0],'>')
return BS2}
BS2.toString=function(){return bs.pop().join('')}
function write(){bs[bs.length-1].push(bs.join.call(arguments,''))}
return BS})([])
F.bs=BS;})();F.__fso=null;F.fso=function(){return F.__fso||(F.__fso=new ActiveXObject('Scripting.FileSystemObject'));};F.includeAll=function(path){var reg=/<\!\-\-#include +(file)?(virtual)?="([^"]+)"\-\->/;var root=(Server.Mappath("/"));var file=new F.File(path);var text=file.getText();var re=[],paths=[file.path],i=j=0,temp,f,p2,tp;while((i=text.search(reg))!==-1){temp=text.match(reg);f=temp[3];if(temp[2])
p2=root+f;else
p2=file.getFolder().path+'/'+f;temp=temp[0];re.push(text.slice(0,i));text=text.slice(i+temp.length);tp=F.includeAll(p2);re.push(tp.text);paths=paths.concat(tp.paths);}
re.push(text);var r={text:re.join(''),paths:paths,path:file.path};return r;};F.aspmin=function(path,outpath){var s=F.includeAll(path).text;var i=s.indexOf('%'+'>');i+=2;var start=s.slice(0,i);s=s.slice(i).replace(new RegExp('<'+'%','g'),'').replace(new RegExp('%'+'>','g'),'');s=F.jsmin(s);var f=new F.File(outpath).create().setText(start+'\n<'+'%'+s+'%'+'>');};F.fetch=function(path,data,opt){opt=opt||{};var key='F_TPL_'+path;var tkey='T'+key;var tmpl=F.cache.get(key);if(opt.checkFile&&tmpl){var t=F.cache.get(tkey);var f=new F.File();if(t.length){t=F.json.parse(t);for(var p in t){if(f.setPath(p).getDateLastModified().getTime()!==t[p]){tmpl=null;break;}}}}
if(!tmpl){var tp=F.includeAll(path);var str=tp.text;var c={evaluate:new RegExp('<'+'%([\\s\\S]+?)%'+'>','g'),interpolate:new RegExp('<'+'%=([\\s\\S]+?)%'+'>','g')};tmpl='var __x=[],print=function(){__x.push.apply(__x,arguments);};'+'with(obj||{}){__x.push(\''+
str.replace(/\\/g,'\\\\').replace(/'/g,"\\'").replace(c.interpolate,function(match,code){return"',"+code.replace(/\\'/g,"'")+",'";}).replace(c.evaluate||null,function(match,code){return"');"+code.replace(/\\'/g,"'").replace(/[\r\n\t]/g,' ')+"__x.push('";}).replace(/\r/g,'\\r').replace(/\n/g,'\\n').replace(/\t/g,'\\t')
+"');}return __x.join('');";var t={},f=new F.File();tp.paths.forEach(function(p){t[p]=f.setPath(p).getDateLastModified().getTime();});F.cache.set(tkey,F.json.stringify(t));F.cache.set(key,tmpl);}
return data?(function(){var html='';try{html=(new Function('obj',tmpl))(data);}catch(e){die(e.message);}finally{return html;}})():tmpl;};(function(){function jsmin(input,level,comment){if(!input)return'';if(!level)level=2;if(!comment)comment='';var a='',b='',EOF=-1,LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz',DIGITS='0123456789',ALNUM=LETTERS+DIGITS+'_$\\',has=function(str,c){return str.indexOf(c)>-1;},theLookahead=EOF;function isAlphanum(c){return c!=EOF&&(has(ALNUM,c)||c.charCodeAt(0)>126);}
var iChar=0,lInput=input.length;function getc(){var c=theLookahead;if(iChar==lInput){return EOF;}
theLookahead=EOF;if(c==EOF){c=input.charAt(iChar);++iChar;}
if(c>=' '||c=='\n'){return c;}
if(c=='\r'){return'\n';}
return' ';}
function getcIC(){var c=theLookahead;if(iChar==lInput){return EOF;}
theLookahead=EOF;if(c==EOF){c=input.charAt(iChar);++iChar;}
if(c>=' '||c=='\n'||c=='\r'){return c;}
return' ';}
function peek(){theLookahead=getc();return theLookahead;}
function next(){var c=getc();if(c=='/'){switch(peek()){case'/':for(;;){c=getc();if(c<='\n'){return c;}}
break;case'*':getc();if(peek()=='!'){getc();var d='/*!';for(;;){c=getcIC();switch(c){case'*':if(peek()=='/'){getc();return d+'*/';}
break;case EOF:throw'Error: Unterminated comment.';default:d+=c;}}}else{for(;;){switch(getc()){case'*':if(peek()=='/'){getc();return' ';}
break;case EOF:throw'Error: Unterminated comment.';}}}
break;default:return c;}}
return c;}
function action(d){var r=[];if(d==1){r.push(a);}
if(d<3){a=b;if(a=='\''||a=='"'){for(;;){r.push(a);a=getc();if(a==b){break;}
if(a<='\n'){throw'Error: unterminated string literal: '+a;}
if(a=='\\'){r.push(a);a=getc();}}}}
b=next();if(b=='/'&&has('(,=:[!&|',a)){r.push(a);r.push(b);for(;;){a=getc();if(a=='/'){break;}else if(a=='\\'){r.push(a);a=getc();}else if(a<='\n'){throw'Error: unterminated Regular Expression literal';}
r.push(a);}
b=next();}
return r.join('');}
function m(){var r=[];a='';r.push(action(3));while(a!=EOF){switch(a){case' ':if(isAlphanum(b)){r.push(action(1));}else{r.push(action(2));}
break;case'\n':switch(b){case'{':case'[':case'(':case'+':case'-':r.push(action(1));break;case' ':r.push(action(3));break;default:if(isAlphanum(b)){r.push(action(1));}else{if(level==1&&b!='\n'){r.push(action(1));}else{r.push(action(2));}}}
break;default:switch(b){case' ':if(isAlphanum(a)){r.push(action(1));break;}
r.push(action(3));break;case'\n':if(level==1&&a!='\n'){r.push(action(1));}else{switch(a){case'}':case']':case')':case'+':case'-':case'"':case'\'':if(level==3){r.push(action(3));}else{r.push(action(1));}
break;default:if(isAlphanum(a)){r.push(action(1));}else{r.push(action(3));}}}
break;default:r.push(action(1));break;}}}
return r.join('');}
ret=m(input);if(comment){return comment+'\n'+ret;}
return ret;}
F.jsmin=jsmin;})();(function(){function js_beautify(js_source_text,options){var input,output,token_text,last_type,last_text,last_last_text,last_word,flags,flag_store,indent_string;var whitespace,wordchar,punct,parser_pos,line_starters,digits;var prefix,token_type,do_block_just_closed;var wanted_newline,just_added_newline,n_newlines;var preindent_string='';options=options?options:{};var opt_brace_style;if(options.space_after_anon_function!==undefined&&options.jslint_happy===undefined){options.jslint_happy=options.space_after_anon_function;}
if(options.braces_on_own_line!==undefined){opt_brace_style=options.braces_on_own_line?"expand":"collapse";}
opt_brace_style=options.brace_style?options.brace_style:(opt_brace_style?opt_brace_style:"collapse");var opt_indent_size=options.indent_size?options.indent_size:4;var opt_indent_char=options.indent_char?options.indent_char:' ';var opt_preserve_newlines=typeof options.preserve_newlines==='undefined'?true:options.preserve_newlines;var opt_max_preserve_newlines=typeof options.max_preserve_newlines==='undefined'?false:options.max_preserve_newlines;var opt_jslint_happy=options.jslint_happy==='undefined'?false:options.jslint_happy;var opt_keep_array_indentation=typeof options.keep_array_indentation==='undefined'?false:options.keep_array_indentation;var opt_space_before_conditional=typeof options.space_before_conditional==='undefined'?true:options.space_before_conditional;var opt_indent_case=typeof options.indent_case==='undefined'?false:options.indent_case;just_added_newline=false;var input_length=js_source_text.length;function trim_output(eat_newlines){eat_newlines=typeof eat_newlines==='undefined'?false:eat_newlines;while(output.length&&(output[output.length-1]===' '||output[output.length-1]===indent_string||output[output.length-1]===preindent_string||(eat_newlines&&(output[output.length-1]==='\n'||output[output.length-1]==='\r')))){output.pop();}}
function trim(s){return s.replace(/^\s\s*|\s\s*$/,'');}
function force_newline()
{var old_keep_array_indentation=opt_keep_array_indentation;opt_keep_array_indentation=false;print_newline()
opt_keep_array_indentation=old_keep_array_indentation;}
function print_newline(ignore_repeated){flags.eat_next_space=false;if(opt_keep_array_indentation&&is_array(flags.mode)){return;}
ignore_repeated=typeof ignore_repeated==='undefined'?true:ignore_repeated;flags.if_line=false;trim_output();if(!output.length){return;}
if(output[output.length-1]!=="\n"||!ignore_repeated){just_added_newline=true;output.push("\n");}
if(preindent_string){output.push(preindent_string);}
for(var i=0;i<flags.indentation_level;i+=1){output.push(indent_string);}
if(flags.var_line&&flags.var_line_reindented){output.push(indent_string);}
if(flags.case_body){output.push(indent_string);}}
function print_single_space(){if(last_type==='TK_COMMENT'){return print_newline(true);}
if(flags.eat_next_space){flags.eat_next_space=false;return;}
var last_output=' ';if(output.length){last_output=output[output.length-1];}
if(last_output!==' '&&last_output!=='\n'&&last_output!==indent_string){output.push(' ');}}
function print_token(){just_added_newline=false;flags.eat_next_space=false;output.push(token_text);}
function indent(){flags.indentation_level+=1;}
function remove_indent(){if(output.length&&output[output.length-1]===indent_string){output.pop();}}
function set_mode(mode){if(flags){flag_store.push(flags);}
flags={previous_mode:flags?flags.mode:'BLOCK',mode:mode,var_line:false,var_line_tainted:false,var_line_reindented:false,in_html_comment:false,if_line:false,in_case:false,case_body:false,eat_next_space:false,indentation_baseline:-1,indentation_level:(flags?flags.indentation_level+(flags.case_body?1:0)+((flags.var_line&&flags.var_line_reindented)?1:0):0),ternary_depth:0};}
function is_array(mode){return mode==='[EXPRESSION]'||mode==='[INDENTED-EXPRESSION]';}
function is_expression(mode){return mode==='[EXPRESSION]'||mode==='[INDENTED-EXPRESSION]'||mode==='(EXPRESSION)';}
function restore_mode(){do_block_just_closed=flags.mode==='DO_BLOCK';if(flag_store.length>0){flags=flag_store.pop();}}
function all_lines_start_with(lines,c){for(var i=0;i<lines.length;i++){if(trim(lines[i])[0]!=c){return false;}}
return true;}
function in_array(what,arr){for(var i=0;i<arr.length;i+=1){if(arr[i]===what){return true;}}
return false;}
function look_up(exclude){var local_pos=parser_pos;var c=input.charAt(local_pos);while(in_array(c,whitespace)&&c!=exclude){local_pos++;if(local_pos>=input_length)return 0;c=input.charAt(local_pos);}
return c;}
function get_next_token(){n_newlines=0;if(parser_pos>=input_length){return['','TK_EOF'];}
wanted_newline=false;var c=input.charAt(parser_pos);parser_pos+=1;var keep_whitespace=opt_keep_array_indentation&&is_array(flags.mode);if(keep_whitespace){var whitespace_count=0;while(in_array(c,whitespace)){if(c==="\n"){trim_output();output.push("\n");just_added_newline=true;whitespace_count=0;}else{if(c==='\t'){whitespace_count+=4;}else if(c==='\r'){}else{whitespace_count+=1;}}
if(parser_pos>=input_length){return['','TK_EOF'];}
c=input.charAt(parser_pos);parser_pos+=1;}
if(flags.indentation_baseline===-1){flags.indentation_baseline=whitespace_count;}
if(just_added_newline){var i;for(i=0;i<flags.indentation_level+1;i+=1){output.push(indent_string);}
if(flags.indentation_baseline!==-1){for(i=0;i<whitespace_count-flags.indentation_baseline;i++){output.push(' ');}}}}else{while(in_array(c,whitespace)){if(c==="\n"){n_newlines+=((opt_max_preserve_newlines)?(n_newlines<=opt_max_preserve_newlines)?1:0:1);}
if(parser_pos>=input_length){return['','TK_EOF'];}
c=input.charAt(parser_pos);parser_pos+=1;}
if(opt_preserve_newlines){if(n_newlines>1){for(i=0;i<n_newlines;i+=1){print_newline(i===0);just_added_newline=true;}}}
wanted_newline=n_newlines>0;}
if(in_array(c,wordchar)){if(parser_pos<input_length){while(in_array(input.charAt(parser_pos),wordchar)){c+=input.charAt(parser_pos);parser_pos+=1;if(parser_pos===input_length){break;}}}
if(parser_pos!==input_length&&c.match(/^[0-9]+[Ee]$/)&&(input.charAt(parser_pos)==='-'||input.charAt(parser_pos)==='+')){var sign=input.charAt(parser_pos);parser_pos+=1;var t=get_next_token(parser_pos);c+=sign+t[0];return[c,'TK_WORD'];}
if(c==='in'){return[c,'TK_OPERATOR'];}
if(wanted_newline&&last_type!=='TK_OPERATOR'&&last_type!=='TK_EQUALS'&&!flags.if_line&&(opt_preserve_newlines||last_text!=='var')){print_newline();}
return[c,'TK_WORD'];}
if(c==='('||c==='['){return[c,'TK_START_EXPR'];}
if(c===')'||c===']'){return[c,'TK_END_EXPR'];}
if(c==='{'){return[c,'TK_START_BLOCK'];}
if(c==='}'){return[c,'TK_END_BLOCK'];}
if(c===';'){return[c,'TK_SEMICOLON'];}
if(c==='/'){var comment='';var inline_comment=true;if(input.charAt(parser_pos)==='*'){parser_pos+=1;if(parser_pos<input_length){while(!(input.charAt(parser_pos)==='*'&&input.charAt(parser_pos+1)&&input.charAt(parser_pos+1)==='/')&&parser_pos<input_length){c=input.charAt(parser_pos);comment+=c;if(c==='\x0d'||c==='\x0a'){inline_comment=false;}
parser_pos+=1;if(parser_pos>=input_length){break;}}}
parser_pos+=2;if(inline_comment&&n_newlines==0){return['/*'+comment+'*/','TK_INLINE_COMMENT'];}else{return['/*'+comment+'*/','TK_BLOCK_COMMENT'];}}
if(input.charAt(parser_pos)==='/'){comment=c;while(input.charAt(parser_pos)!=='\r'&&input.charAt(parser_pos)!=='\n'){comment+=input.charAt(parser_pos);parser_pos+=1;if(parser_pos>=input_length){break;}}
parser_pos+=1;if(wanted_newline){print_newline();}
return[comment,'TK_COMMENT'];}}
if(c==="'"||c==='"'||(c==='/'&&((last_type==='TK_WORD'&&in_array(last_text,['return','do','else']))||(last_type==='TK_COMMENT'||last_type==='TK_START_EXPR'||last_type==='TK_START_BLOCK'||last_type==='TK_END_BLOCK'||last_type==='TK_OPERATOR'||last_type==='TK_EQUALS'||last_type==='TK_EOF'||last_type==='TK_SEMICOLON')))){var sep=c;var esc=false;var resulting_string=c;if(parser_pos<input_length){if(sep==='/'){var in_char_class=false;while(esc||in_char_class||input.charAt(parser_pos)!==sep){resulting_string+=input.charAt(parser_pos);if(!esc){esc=input.charAt(parser_pos)==='\\';if(input.charAt(parser_pos)==='['){in_char_class=true;}else if(input.charAt(parser_pos)===']'){in_char_class=false;}}else{esc=false;}
parser_pos+=1;if(parser_pos>=input_length){return[resulting_string,'TK_STRING'];}}}else{while(esc||input.charAt(parser_pos)!==sep){resulting_string+=input.charAt(parser_pos);if(!esc){esc=input.charAt(parser_pos)==='\\';}else{esc=false;}
parser_pos+=1;if(parser_pos>=input_length){return[resulting_string,'TK_STRING'];}}}}
parser_pos+=1;resulting_string+=sep;if(sep==='/'){while(parser_pos<input_length&&in_array(input.charAt(parser_pos),wordchar)){resulting_string+=input.charAt(parser_pos);parser_pos+=1;}}
return[resulting_string,'TK_STRING'];}
if(c==='#'){if(output.length===0&&input.charAt(parser_pos)==='!'){resulting_string=c;while(parser_pos<input_length&&c!='\n'){c=input.charAt(parser_pos);resulting_string+=c;parser_pos+=1;}
output.push(trim(resulting_string)+'\n');print_newline();return get_next_token();}
var sharp='#';if(parser_pos<input_length&&in_array(input.charAt(parser_pos),digits)){do{c=input.charAt(parser_pos);sharp+=c;parser_pos+=1;}while(parser_pos<input_length&&c!=='#'&&c!=='=');if(c==='#'){}else if(input.charAt(parser_pos)==='['&&input.charAt(parser_pos+1)===']'){sharp+='[]';parser_pos+=2;}else if(input.charAt(parser_pos)==='{'&&input.charAt(parser_pos+1)==='}'){sharp+='{}';parser_pos+=2;}
return[sharp,'TK_WORD'];}}
if(c==='<'&&input.substring(parser_pos-1,parser_pos+3)==='<!--'){parser_pos+=3;flags.in_html_comment=true;return['<!--','TK_COMMENT'];}
if(c==='-'&&flags.in_html_comment&&input.substring(parser_pos-1,parser_pos+2)==='-->'){flags.in_html_comment=false;parser_pos+=2;if(wanted_newline){print_newline();}
return['-->','TK_COMMENT'];}
if(in_array(c,punct)){while(parser_pos<input_length&&in_array(c+input.charAt(parser_pos),punct)){c+=input.charAt(parser_pos);parser_pos+=1;if(parser_pos>=input_length){break;}}
if(c==='='){return[c,'TK_EQUALS'];}else{return[c,'TK_OPERATOR'];}}
return[c,'TK_UNKNOWN'];}
indent_string='';while(opt_indent_size>0){indent_string+=opt_indent_char;opt_indent_size-=1;}
while(js_source_text&&(js_source_text[0]===' '||js_source_text[0]==='\t')){preindent_string+=js_source_text[0];js_source_text=js_source_text.substring(1);}
input=js_source_text;last_word='';last_type='TK_START_EXPR';last_text='';last_last_text='';output=[];do_block_just_closed=false;whitespace="\n\r\t ".split('');wordchar='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$'.split('');digits='0123456789'.split('');punct='+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::';punct+=' <'+'%= <'+'% %'+'> <?= <? ?>';punct=punct.split(' ');line_starters='continue,try,throw,return,var,if,switch,case,default,for,while,break,function'.split(',');flag_store=[];set_mode('BLOCK');parser_pos=0;while(true){var t=get_next_token(parser_pos);token_text=t[0];token_type=t[1];if(token_type==='TK_EOF'){break;}
switch(token_type){case'TK_START_EXPR':if(token_text==='['){if(last_type==='TK_WORD'||last_text===')'){if(in_array(last_text,line_starters)){print_single_space();}
set_mode('(EXPRESSION)');print_token();break;}
if(flags.mode==='[EXPRESSION]'||flags.mode==='[INDENTED-EXPRESSION]'){if(last_last_text===']'&&last_text===','){if(flags.mode==='[EXPRESSION]'){flags.mode='[INDENTED-EXPRESSION]';if(!opt_keep_array_indentation){indent();}}
set_mode('[EXPRESSION]');if(!opt_keep_array_indentation){print_newline();}}else if(last_text==='['){if(flags.mode==='[EXPRESSION]'){flags.mode='[INDENTED-EXPRESSION]';if(!opt_keep_array_indentation){indent();}}
set_mode('[EXPRESSION]');if(!opt_keep_array_indentation){print_newline();}}else{set_mode('[EXPRESSION]');}}else{set_mode('[EXPRESSION]');}}else{set_mode('(EXPRESSION)');}
if(last_text===';'||last_type==='TK_START_BLOCK'){print_newline();}else if(last_type==='TK_END_EXPR'||last_type==='TK_START_EXPR'||last_type==='TK_END_BLOCK'||last_text==='.'){if(wanted_newline){print_newline();}}else if(last_type!=='TK_WORD'&&last_type!=='TK_OPERATOR'){print_single_space();}else if(last_word==='function'||last_word==='typeof'){if(opt_jslint_happy){print_single_space();}}else if(in_array(last_text,line_starters)||last_text==='catch'){if(opt_space_before_conditional){print_single_space();}}
print_token();break;case'TK_END_EXPR':if(token_text===']'){if(opt_keep_array_indentation){if(last_text==='}'){remove_indent();print_token();restore_mode();break;}}else{if(flags.mode==='[INDENTED-EXPRESSION]'){if(last_text===']'){restore_mode();print_newline();print_token();break;}}}}
restore_mode();print_token();break;case'TK_START_BLOCK':if(last_word==='do'){set_mode('DO_BLOCK');}else{set_mode('BLOCK');}
if(opt_brace_style=="expand"||opt_brace_style=="expand-strict"){var empty_braces=false;if(opt_brace_style=="expand-strict")
{empty_braces=(look_up()=='}');if(!empty_braces){print_newline(true);}}else{if(last_type!=='TK_OPERATOR'){if(last_text==='return'||last_text==='='){print_single_space();}else{print_newline(true);}}}
print_token();if(!empty_braces)indent();}else{if(last_type!=='TK_OPERATOR'&&last_type!=='TK_START_EXPR'){if(last_type==='TK_START_BLOCK'){print_newline();}else{print_single_space();}}else{if(is_array(flags.previous_mode)&&last_text===','){if(last_last_text==='}'){print_single_space();}else{print_newline();}}}
indent();print_token();}
break;case'TK_END_BLOCK':restore_mode();if(opt_brace_style=="expand"||opt_brace_style=="expand-strict"){if(last_text!=='{'){print_newline();}
print_token();}else{if(last_type==='TK_START_BLOCK'){if(just_added_newline){remove_indent();}else{trim_output();}}else{if(is_array(flags.mode)&&opt_keep_array_indentation){opt_keep_array_indentation=false;print_newline();opt_keep_array_indentation=true;}else{print_newline();}}
print_token();}
break;case'TK_WORD':if(do_block_just_closed){print_single_space();print_token();print_single_space();do_block_just_closed=false;break;}
if(token_text==='function'){if(flags.var_line){flags.var_line_reindented=true;}
if((just_added_newline||last_text===';')&&last_text!=='{'&&last_type!='TK_BLOCK_COMMENT'&&last_type!='TK_COMMENT'){n_newlines=just_added_newline?n_newlines:0;if(!opt_preserve_newlines){n_newlines=1;}
for(var i=0;i<2-n_newlines;i++){print_newline(false);}}}
if(token_text==='case'||token_text==='default'){if(last_text===':'||flags.case_body){remove_indent();}else{if(!opt_indent_case)
flags.indentation_level--;print_newline();if(!opt_indent_case)
flags.indentation_level++;}
print_token();flags.in_case=true;flags.case_body=false;break;}
prefix='NONE';if(last_type==='TK_END_BLOCK'){if(!in_array(token_text.toLowerCase(),['else','catch','finally'])){prefix='NEWLINE';}else{if(opt_brace_style=="expand"||opt_brace_style=="end-expand"||opt_brace_style=="expand-strict"){prefix='NEWLINE';}else{prefix='SPACE';print_single_space();}}}else if(last_type==='TK_SEMICOLON'&&(flags.mode==='BLOCK'||flags.mode==='DO_BLOCK')){prefix='NEWLINE';}else if(last_type==='TK_SEMICOLON'&&is_expression(flags.mode)){prefix='SPACE';}else if(last_type==='TK_STRING'){prefix='NEWLINE';}else if(last_type==='TK_WORD'){if(last_text==='else'){trim_output(true);}
prefix='SPACE';}else if(last_type==='TK_START_BLOCK'){prefix='NEWLINE';}else if(last_type==='TK_END_EXPR'){print_single_space();prefix='NEWLINE';}
if(in_array(token_text,line_starters)&&last_text!==')'){if(last_text=='else'){prefix='SPACE';}else{prefix='NEWLINE';}
if(token_text==='function'&&(last_text==='get'||last_text==='set')){prefix='SPACE';}}
if(flags.if_line&&last_type==='TK_END_EXPR'){flags.if_line=false;}
if(in_array(token_text.toLowerCase(),['else','catch','finally'])){if(last_type!=='TK_END_BLOCK'||opt_brace_style=="expand"||opt_brace_style=="end-expand"||opt_brace_style=="expand-strict"){print_newline();}else{trim_output(true);print_single_space();}}else if(prefix==='NEWLINE'){if((last_type==='TK_START_EXPR'||last_text==='='||last_text===',')&&token_text==='function'){}else if(token_text==='function'&&last_text=='new'){print_single_space();}else if(last_text==='return'||last_text==='throw'){print_single_space();}else if(last_type!=='TK_END_EXPR'){if((last_type!=='TK_START_EXPR'||token_text!=='var')&&last_text!==':'){if(token_text==='if'&&last_word==='else'&&last_text!=='{'){print_single_space();}else{flags.var_line=false;flags.var_line_reindented=false;print_newline();}}}else if(in_array(token_text,line_starters)&&last_text!=')'){flags.var_line=false;flags.var_line_reindented=false;print_newline();}}else if(is_array(flags.mode)&&last_text===','&&last_last_text==='}'){print_newline();}else if(prefix==='SPACE'){print_single_space();}
print_token();last_word=token_text;if(token_text==='var'){flags.var_line=true;flags.var_line_reindented=false;flags.var_line_tainted=false;}
if(token_text==='if'){flags.if_line=true;}
if(token_text==='else'){flags.if_line=false;}
break;case'TK_SEMICOLON':print_token();flags.var_line=false;flags.var_line_reindented=false;if(flags.mode=='OBJECT'){flags.mode='BLOCK';}
break;case'TK_STRING':if(last_type=='TK_STRING'||last_type==='TK_START_BLOCK'||last_type==='TK_END_BLOCK'||last_type==='TK_SEMICOLON'){print_newline();}else if(last_type==='TK_WORD'){print_single_space();}
print_token();break;case'TK_EQUALS':if(flags.var_line){flags.var_line_tainted=true;}
print_single_space();print_token();print_single_space();break;case'TK_OPERATOR':var space_before=true;var space_after=true;if(flags.var_line&&token_text===','&&(is_expression(flags.mode))){flags.var_line_tainted=false;}
if(flags.var_line){if(token_text===','){if(flags.var_line_tainted){print_token();flags.var_line_reindented=true;flags.var_line_tainted=false;print_newline();break;}else{flags.var_line_tainted=false;}}}
if(last_text==='return'||last_text==='throw'){print_single_space();print_token();break;}
if(token_text===':'&&flags.in_case){if(opt_indent_case)
flags.case_body=true;print_token();print_newline();flags.in_case=false;break;}
if(token_text==='::'){print_token();break;}
if(token_text===','){if(flags.var_line){if(flags.var_line_tainted){print_token();print_newline();flags.var_line_tainted=false;}else{print_token();print_single_space();}}else if(last_type==='TK_END_BLOCK'&&flags.mode!=="(EXPRESSION)"){print_token();if(flags.mode==='OBJECT'&&last_text==='}'){print_newline();}else{print_single_space();}}else{if(flags.mode==='OBJECT'){print_token();print_newline();}else{print_token();print_single_space();}}
break;}else if(in_array(token_text,['--','++','!'])||(in_array(token_text,['-','+'])&&(in_array(last_type,['TK_START_BLOCK','TK_START_EXPR','TK_EQUALS','TK_OPERATOR'])||in_array(last_text,line_starters)))){space_before=false;space_after=false;if(last_text===';'&&is_expression(flags.mode)){space_before=true;}
if(last_type==='TK_WORD'&&in_array(last_text,line_starters)){space_before=true;}
if(flags.mode==='BLOCK'&&(last_text==='{'||last_text===';')){print_newline();}}else if(token_text==='.'){space_before=false;}else if(token_text===':'){if(flags.ternary_depth==0){flags.mode='OBJECT';space_before=false;}else{flags.ternary_depth-=1;}}else if(token_text==='?'){flags.ternary_depth+=1;}
if(space_before){print_single_space();}
print_token();if(space_after){print_single_space();}
if(token_text==='!'){}
break;case'TK_BLOCK_COMMENT':var lines=token_text.split(/\x0a|\x0d\x0a/);if(all_lines_start_with(lines.slice(1),'*')){print_newline();output.push(lines[0]);for(i=1;i<lines.length;i++){print_newline();output.push(' ');output.push(trim(lines[i]));}}else{if(lines.length>1){print_newline();}else{if(last_type==='TK_END_BLOCK'){print_newline();}else{print_single_space();}}
for(i=0;i<lines.length;i++){output.push(lines[i]);output.push('\n');}}
if(look_up('\n')!='\n')
print_newline();break;case'TK_INLINE_COMMENT':print_single_space();print_token();if(is_expression(flags.mode)){print_single_space();}else{force_newline();}
break;case'TK_COMMENT':if(wanted_newline){print_newline();}else{print_single_space();}
print_token();if(look_up('\n')!='\n')
force_newline();break;case'TK_UNKNOWN':if(last_text==='return'||last_text==='throw'){print_single_space();}
print_token();break;}
last_last_text=last_text;last_type=token_type;last_text=token_text;}
var sweet_code=preindent_string+output.join('').replace(/[\n ]+$/,'');return sweet_code;}
if(typeof exports!=="undefined")
exports.js_beautify=js_beautify;F.formatJSON=js_beautify;})();F.namespace('F.string');(function(F){var hexcase=0;var b64pad="";var chrsz=8;function hex_md5(s){return binl2hex(core_md5(str2binl(s),s.length*chrsz));}
function b64_md5(s){return binl2b64(core_md5(str2binl(s),s.length*chrsz));}
function str_md5(s){return binl2str(core_md5(str2binl(s),s.length*chrsz));}
function hex_hmac_md5(key,data){return binl2hex(core_hmac_md5(key,data));}
function b64_hmac_md5(key,data){return binl2b64(core_hmac_md5(key,data));}
function str_hmac_md5(key,data){return binl2str(core_hmac_md5(key,data));}
F.md5=hex_md5;F.hex_md5=hex_md5;F.b64_md5=b64_md5;F.str_md5=str_md5;F.hex_hmac_md5=hex_hmac_md5;F.b64_hmac_md5=b64_hmac_md5;F.str_hmac_md5=str_hmac_md5;function md5_vm_test()
{return hex_md5("abc")=="900150983cd24fb0d6963f7d28e17f72";}
function core_md5(x,len)
{x[len>>5]|=0x80<<((len)%32);x[(((len+64)>>>9)<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16)
{var olda=a;var oldb=b;var oldc=c;var oldd=d;a=md5_ff(a,b,c,d,x[i+0],7,-680876936);d=md5_ff(d,a,b,c,x[i+1],12,-389564586);c=md5_ff(c,d,a,b,x[i+2],17,606105819);b=md5_ff(b,c,d,a,x[i+3],22,-1044525330);a=md5_ff(a,b,c,d,x[i+4],7,-176418897);d=md5_ff(d,a,b,c,x[i+5],12,1200080426);c=md5_ff(c,d,a,b,x[i+6],17,-1473231341);b=md5_ff(b,c,d,a,x[i+7],22,-45705983);a=md5_ff(a,b,c,d,x[i+8],7,1770035416);d=md5_ff(d,a,b,c,x[i+9],12,-1958414417);c=md5_ff(c,d,a,b,x[i+10],17,-42063);b=md5_ff(b,c,d,a,x[i+11],22,-1990404162);a=md5_ff(a,b,c,d,x[i+12],7,1804603682);d=md5_ff(d,a,b,c,x[i+13],12,-40341101);c=md5_ff(c,d,a,b,x[i+14],17,-1502002290);b=md5_ff(b,c,d,a,x[i+15],22,1236535329);a=md5_gg(a,b,c,d,x[i+1],5,-165796510);d=md5_gg(d,a,b,c,x[i+6],9,-1069501632);c=md5_gg(c,d,a,b,x[i+11],14,643717713);b=md5_gg(b,c,d,a,x[i+0],20,-373897302);a=md5_gg(a,b,c,d,x[i+5],5,-701558691);d=md5_gg(d,a,b,c,x[i+10],9,38016083);c=md5_gg(c,d,a,b,x[i+15],14,-660478335);b=md5_gg(b,c,d,a,x[i+4],20,-405537848);a=md5_gg(a,b,c,d,x[i+9],5,568446438);d=md5_gg(d,a,b,c,x[i+14],9,-1019803690);c=md5_gg(c,d,a,b,x[i+3],14,-187363961);b=md5_gg(b,c,d,a,x[i+8],20,1163531501);a=md5_gg(a,b,c,d,x[i+13],5,-1444681467);d=md5_gg(d,a,b,c,x[i+2],9,-51403784);c=md5_gg(c,d,a,b,x[i+7],14,1735328473);b=md5_gg(b,c,d,a,x[i+12],20,-1926607734);a=md5_hh(a,b,c,d,x[i+5],4,-378558);d=md5_hh(d,a,b,c,x[i+8],11,-2022574463);c=md5_hh(c,d,a,b,x[i+11],16,1839030562);b=md5_hh(b,c,d,a,x[i+14],23,-35309556);a=md5_hh(a,b,c,d,x[i+1],4,-1530992060);d=md5_hh(d,a,b,c,x[i+4],11,1272893353);c=md5_hh(c,d,a,b,x[i+7],16,-155497632);b=md5_hh(b,c,d,a,x[i+10],23,-1094730640);a=md5_hh(a,b,c,d,x[i+13],4,681279174);d=md5_hh(d,a,b,c,x[i+0],11,-358537222);c=md5_hh(c,d,a,b,x[i+3],16,-722521979);b=md5_hh(b,c,d,a,x[i+6],23,76029189);a=md5_hh(a,b,c,d,x[i+9],4,-640364487);d=md5_hh(d,a,b,c,x[i+12],11,-421815835);c=md5_hh(c,d,a,b,x[i+15],16,530742520);b=md5_hh(b,c,d,a,x[i+2],23,-995338651);a=md5_ii(a,b,c,d,x[i+0],6,-198630844);d=md5_ii(d,a,b,c,x[i+7],10,1126891415);c=md5_ii(c,d,a,b,x[i+14],15,-1416354905);b=md5_ii(b,c,d,a,x[i+5],21,-57434055);a=md5_ii(a,b,c,d,x[i+12],6,1700485571);d=md5_ii(d,a,b,c,x[i+3],10,-1894986606);c=md5_ii(c,d,a,b,x[i+10],15,-1051523);b=md5_ii(b,c,d,a,x[i+1],21,-2054922799);a=md5_ii(a,b,c,d,x[i+8],6,1873313359);d=md5_ii(d,a,b,c,x[i+15],10,-30611744);c=md5_ii(c,d,a,b,x[i+6],15,-1560198380);b=md5_ii(b,c,d,a,x[i+13],21,1309151649);a=md5_ii(a,b,c,d,x[i+4],6,-145523070);d=md5_ii(d,a,b,c,x[i+11],10,-1120210379);c=md5_ii(c,d,a,b,x[i+2],15,718787259);b=md5_ii(b,c,d,a,x[i+9],21,-343485551);a=safe_add(a,olda);b=safe_add(b,oldb);c=safe_add(c,oldc);d=safe_add(d,oldd);}
return Array(a,b,c,d);}
function md5_cmn(q,a,b,x,s,t)
{return safe_add(bit_rol(safe_add(safe_add(a,q),safe_add(x,t)),s),b);}
function md5_ff(a,b,c,d,x,s,t)
{return md5_cmn((b&c)|((~b)&d),a,b,x,s,t);}
function md5_gg(a,b,c,d,x,s,t)
{return md5_cmn((b&d)|(c&(~d)),a,b,x,s,t);}
function md5_hh(a,b,c,d,x,s,t)
{return md5_cmn(b^c^d,a,b,x,s,t);}
function md5_ii(a,b,c,d,x,s,t)
{return md5_cmn(c^(b|(~d)),a,b,x,s,t);}
function core_hmac_md5(key,data)
{var bkey=str2binl(key);if(bkey.length>16)bkey=core_md5(bkey,key.length*chrsz);var ipad=Array(16),ōpad=Array(16);for(var i=0;i<16;i++)
{ipad[i]=bkey[i]^0x36363636;opad[i]=bkey[i]^0x5C5C5C5C;}
var hash=core_md5(ipad.concat(str2binl(data)),512+data.length*chrsz);return core_md5(opad.concat(hash),512+128);}
function safe_add(x,y)
{var lsw=(x&0xFFFF)+(y&0xFFFF);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&0xFFFF);}
function bit_rol(num,cnt)
{return(num<<cnt)|(num>>>(32-cnt));}
function str2binl(str)
{var bin=Array();var mask=(1<<chrsz)-1;for(var i=0;i<str.length*chrsz;i+=chrsz)
bin[i>>5]|=(str.charCodeAt(i/chrsz)&mask)<<(i%32);return bin;}
function binl2str(bin)
{var str="";var mask=(1<<chrsz)-1;for(var i=0;i<bin.length*32;i+=chrsz)
str+=String.fromCharCode((bin[i>>5]>>>(i%32))&mask);return str;}
function binl2hex(binarray)
{var hex_tab=hexcase?"0123456789ABCDEF":"0123456789abcdef";var str="";for(var i=0;i<binarray.length*4;i++)
{str+=hex_tab.charAt((binarray[i>>2]>>((i%4)*8+4))&0xF)+
hex_tab.charAt((binarray[i>>2]>>((i%4)*8))&0xF);}
return str;}
function binl2b64(binarray)
{var tab="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var str="";for(var i=0;i<binarray.length*4;i+=3)
{var triplet=(((binarray[i>>2]>>8*(i%4))&0xFF)<<16)|(((binarray[i+1>>2]>>8*((i+1)%4))&0xFF)<<8)|((binarray[i+2>>2]>>8*((i+2)%4))&0xFF);for(var j=0;j<4;j++)
{if(i*8+j*6>binarray.length*32)str+=b64pad;else str+=tab.charAt((triplet>>6*(3-j))&0x3F);}}
return str;}})(F);(function(){var Showdown={};Showdown.converter=function(){var g_urls;var g_titles;var g_html_blocks;var g_list_level=0;this.makeHtml=function(text){g_urls=new Array();g_titles=new Array();g_html_blocks=new Array();text=text.replace(/~/g,"~T");text=text.replace(/\$/g,"~D");text=text.replace(/\r\n/g,"\n");text=text.replace(/\r/g,"\n");text="\n\n"+text+"\n\n";text=_Detab(text);text=text.replace(/^[ \t]+$/mg,"");text=_HashHTMLBlocks(text);text=_StripLinkDefinitions(text);text=_RunBlockGamut(text);text=_UnescapeSpecialChars(text);text=text.replace(/~D/g,"$$");text=text.replace(/~T/g,"~");return text;}
var _StripLinkDefinitions=function(text){var text=text.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|\Z)/gm,function(wholeMatch,m1,m2,m3,m4){m1=m1.toLowerCase();g_urls[m1]=_EncodeAmpsAndAngles(m2);if(m3){return m3+m4;}else if(m4){g_titles[m1]=m4.replace(/"/g,"&quot;");}
return"";});return text;}
var _HashHTMLBlocks=function(text){text=text.replace(/\n/g,"\n\n");var block_tags_a="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del"
var block_tags_b="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math"
text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,hashElement);text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,hashElement);text=text.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/\n\n/g,"\n");return text;}
var hashElement=function(wholeMatch,m1){var blockText=m1;blockText=blockText.replace(/\n\n/g,"\n");blockText=blockText.replace(/^\n/,"");blockText=blockText.replace(/\n+$/g,"");blockText="\n\n~K"+(g_html_blocks.push(blockText)-1)+"K\n\n";return blockText;};var _RunBlockGamut=function(text){text=_DoHeaders(text);var key=hashBlock("<hr />");text=text.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,key);text=_DoLists(text);text=_DoCodeBlocks(text);text=_DoBlockQuotes(text);text=_HashHTMLBlocks(text);text=_FormParagraphs(text);return text;}
var _RunSpanGamut=function(text){text=_DoCodeSpans(text);text=_EscapeSpecialCharsWithinTagAttributes(text);text=_EncodeBackslashEscapes(text);text=_DoImages(text);text=_DoAnchors(text);text=_DoAutoLinks(text);text=_EncodeAmpsAndAngles(text);text=_DoItalicsAndBold(text);text=text.replace(/  +\n/g," <br />\n");return text;}
var _EscapeSpecialCharsWithinTagAttributes=function(text){var regex=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\/?code>(?=.)/g,"$1`");tag=escapeCharacters(tag,"\\`*_");return tag;});return text;}
var _DoAnchors=function(text){text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeAnchorTag);text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeAnchorTag);text=text.replace(/(\[([^\[\]]+)\])()()()()()/g,writeAnchorTag);return text;}
var writeAnchorTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){if(m7==undefined)m7="";var whole_match=m1;var link_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(url==""){if(link_id==""){link_id=link_text.toLowerCase().replace(/ ?\n/g," ");}
url="#"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id];}}
else{if(whole_match.search(/\(\s*\)$/m)>-1){url="";}else{return whole_match;}}}
url=escapeCharacters(url,"*_");var result="<a href=\""+url+"\"";if(title!=""){title=title.replace(/"/g,"&quot;");title=escapeCharacters(title,"*_");result+=" title=\""+title+"\"";}
result+=">"+link_text+"</a>";return result;}
var _DoImages=function(text){text=text.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeImageTag);text=text.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeImageTag);return text;}
var writeImageTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){var whole_match=m1;var alt_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(!title)title="";if(url==""){if(link_id==""){link_id=alt_text.toLowerCase().replace(/ ?\n/g," ");}
url="#"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id];}}
else{return whole_match;}}
alt_text=alt_text.replace(/"/g,"&quot;");url=escapeCharacters(url,"*_");var result="<img src=\""+url+"\" alt=\""+alt_text+"\"";title=title.replace(/"/g,"&quot;");title=escapeCharacters(title,"*_");result+=" title=\""+title+"\"";result+=" />";return result;}
var _DoHeaders=function(text){text=text.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(wholeMatch,m1){return hashBlock('<h1 id="'+headerId(m1)+'">'+_RunSpanGamut(m1)+"</h1>");});text=text.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(matchFound,m1){return hashBlock('<h2 id="'+headerId(m1)+'">'+_RunSpanGamut(m1)+"</h2>");});text=text.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(wholeMatch,m1,m2){var h_level=m1.length;return hashBlock("<h"+h_level+' id="'+headerId(m2)+'">'+_RunSpanGamut(m2)+"</h"+h_level+">");});function headerId(m){return m.replace(/[^\w]/g,'').toLowerCase();}
return text;}
var _ProcessListItems;var _DoLists=function(text){text+="~0";var whole_list=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;if(g_list_level){text=text.replace(whole_list,function(wholeMatch,m1,m2){var list=m1;var list_type=(m2.search(/[*+-]/g)>-1)?"ul":"ol";list=list.replace(/\n{2,}/g,"\n\n\n");;var result=_ProcessListItems(list);result=result.replace(/\s+$/,"");result="<"+list_type+">"+result+"</"+list_type+">\n";return result;});}else{whole_list=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g;text=text.replace(whole_list,function(wholeMatch,m1,m2,m3){var runup=m1;var list=m2;var list_type=(m3.search(/[*+-]/g)>-1)?"ul":"ol";var list=list.replace(/\n{2,}/g,"\n\n\n");;var result=_ProcessListItems(list);result=runup+"<"+list_type+">\n"+result+"</"+list_type+">\n";return result;});}
text=text.replace(/~0/,"");return text;}
_ProcessListItems=function(list_str){g_list_level++;list_str=list_str.replace(/\n{2,}$/,"\n");list_str+="~0";list_str=list_str.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(wholeMatch,m1,m2,m3,m4){var item=m4;var leading_line=m1;var leading_space=m2;if(leading_line||(item.search(/\n{2,}/)>-1)){item=_RunBlockGamut(_Outdent(item));}
else{item=_DoLists(_Outdent(item));item=item.replace(/\n$/,"");item=_RunSpanGamut(item);}
return"<li>"+item+"</li>\n";});list_str=list_str.replace(/~0/g,"");g_list_level--;return list_str;}
var _DoCodeBlocks=function(text){text+="~0";text=text.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(wholeMatch,m1,m2){var codeblock=m1;var nextChar=m2;codeblock=_EncodeCode(_Outdent(codeblock));codeblock=_Detab(codeblock);codeblock=codeblock.replace(/^\n+/g,"");codeblock=codeblock.replace(/\n+$/g,"");codeblock="<pre><code>"+codeblock+"\n</code></pre>";return hashBlock(codeblock)+nextChar;});text=text.replace(/~0/,"");return text;}
var hashBlock=function(text){text=text.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(g_html_blocks.push(text)-1)+"K\n\n";}
var _DoCodeSpans=function(text){text=text.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(wholeMatch,m1,m2,m3,m4){var c=m3;c=c.replace(/^([ \t]*)/g,"");c=c.replace(/[ \t]*$/g,"");c=_EncodeCode(c);return m1+"<code>"+c+"</code>";});return text;}
var _EncodeCode=function(text){text=text.replace(/&/g,"&amp;");text=text.replace(/</g,"&lt;");text=text.replace(/>/g,"&gt;");text=escapeCharacters(text,"\*_{}[]\\",false);return text;}
var _DoItalicsAndBold=function(text){text=text.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>");text=text.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");return text;}
var _DoBlockQuotes=function(text){text=text.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(wholeMatch,m1){var bq=m1;bq=bq.replace(/^[ \t]*>[ \t]?/gm,"~0");bq=bq.replace(/~0/g,"");bq=bq.replace(/^[ \t]+$/gm,"");bq=_RunBlockGamut(bq);bq=bq.replace(/(^|\n)/g,"$1  ");bq=bq.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(wholeMatch,m1){var pre=m1;pre=pre.replace(/^  /mg,"~0");pre=pre.replace(/~0/g,"");return pre;});return hashBlock("<blockquote>\n"+bq+"\n</blockquote>");});return text;}
var _FormParagraphs=function(text){text=text.replace(/^\n+/g,"");text=text.replace(/\n+$/g,"");var grafs=text.split(/\n{2,}/g);var grafsOut=new Array();var end=grafs.length;for(var i=0;i<end;i++){var str=grafs[i];if(str.search(/~K(\d+)K/g)>=0){grafsOut.push(str);}
else if(str.search(/\S/)>=0){str=_RunSpanGamut(str);str=str.replace(/^([ \t]*)/g,"<p>");str+="</p>"
grafsOut.push(str);}}
end=grafsOut.length;for(var i=0;i<end;i++){while(grafsOut[i].search(/~K(\d+)K/)>=0){var blockText=g_html_blocks[RegExp.$1];blockText=blockText.replace(/\$/g,"$$$$");grafsOut[i]=grafsOut[i].replace(/~K\d+K/,blockText);}}
return grafsOut.join("\n\n");}
var _EncodeAmpsAndAngles=function(text){text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");text=text.replace(/<(?![a-z\/?\$!])/gi,"&lt;");return text;}
var _EncodeBackslashEscapes=function(text){text=text.replace(/\\(\\)/g,escapeCharacters_callback);text=text.replace(/\\([`*_{}\[\]()>#+-.!])/g,escapeCharacters_callback);return text;}
var _DoAutoLinks=function(text){text=text.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,"<a href=\"$1\">$1</a>");text=text.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(wholeMatch,m1){return _EncodeEmailAddress(_UnescapeSpecialChars(m1));});return text;}
var _EncodeEmailAddress=function(addr){function char2hex(ch){var hexDigits='0123456789ABCDEF';var dec=ch.charCodeAt(0);return(hexDigits.charAt(dec>>4)+hexDigits.charAt(dec&15));}
var encode=[function(ch){return"&#"+ch.charCodeAt(0)+";";},function(ch){return"&#x"+char2hex(ch)+";";},function(ch){return ch;}];addr="mailto:"+addr;addr=addr.replace(/./g,function(ch){if(ch=="@"){ch=encode[Math.floor(Math.random()*2)](ch);}else if(ch!=":"){var r=Math.random();ch=(r>.9?encode[2](ch):r>.45?encode[1](ch):encode[0](ch));}
return ch;});addr="<a href=\""+addr+"\">"+addr+"</a>";addr=addr.replace(/">.+:/g,"\">");return addr;}
var _UnescapeSpecialChars=function(text){text=text.replace(/~E(\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace);});return text;}
var _Outdent=function(text){text=text.replace(/^(\t|[ ]{1,4})/gm,"~0");text=text.replace(/~0/g,"")
return text;}
var _Detab=function(text){text=text.replace(/\t(?=\t)/g,"    ");text=text.replace(/\t/g,"~A~B");text=text.replace(/~B(.+?)~A/g,function(wholeMatch,m1,m2){var leadingText=m1;var numSpaces=4-leadingText.length%4;for(var i=0;i<numSpaces;i++)leadingText+=" ";return leadingText;});text=text.replace(/~A/g,"    ");text=text.replace(/~B/g,"");return text;}
var escapeCharacters=function(text,charsToEscape,afterBackslash){var regexString="(["+charsToEscape.replace(/([\[\]\\])/g,"\\$1")+"])";if(afterBackslash){regexString="\\\\"+regexString;}
var regex=new RegExp(regexString,"g");text=text.replace(regex,escapeCharacters_callback);return text;}
var escapeCharacters_callback=function(wholeMatch,m1){var charCodeToEscape=m1.charCodeAt(0);return"~E"+charCodeToEscape+"E";}}
F.markdown=function(text){return new Showdown.converter().makeHtml(text);};})();F.string.base64Encode=function(str){var b64ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");var b64="",b=0,len=str.length;for(var i=0;i<len;i++){b=str.charCodeAt(i)<<16&0xFF0000;b|=str.charCodeAt(++i)<<8&0xFF00;b|=str.charCodeAt(++i)&0xFF;b64+=b64ch[b>>>18];b64+=b64ch[b>>>12&0x3F];b64+=b64ch[b>>>6&0x3F];b64+=b64ch[b&0x3F];}
if(len%3==1){b64=b64.slice(0,-2)+"==";}else if(len%3==2){b64=b64.slice(0,-1)+"=";}
return b64;};F.string.base64Decode=function(b64){var b64ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var str="",len=0,unit="",b=0;b64=b64.replace(/[^\d\w\+\/]/g,"");len=b64.length;for(var i=0;i<len;i++){b=b64ch.indexOf(b64.charAt(i))<<18;b|=b64ch.indexOf(b64.charAt(++i))<<12;b|=b64ch.indexOf(b64.charAt(++i))<<6;b|=b64ch.indexOf(b64.charAt(++i));unit=(b|0x1000000).toString(16);str+="%"+unit.substr(1,2)
str+="%"+unit.substr(3,2)
str+="%"+unit.substr(5,2);}
if(len%4){str=str.slice(0,(len%4-4)*3);}
return unescape(str);};F.string.base64EncodeUTF8=function(str){var b64ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");var utf8=unescape(encodeURIComponent(str));var b64="",b=0,len=utf8.length;for(var i=0;i<len;i++){b=utf8.charCodeAt(i)<<16;b|=utf8.charCodeAt(++i)<<8;b|=utf8.charCodeAt(++i);b64+=b64ch[b>>>18];b64+=b64ch[b>>>12&0x3F];b64+=b64ch[b>>>6&0x3F];b64+=b64ch[b&0x3F];}
if(len%3==1){b64=b64.slice(0,-2)+"==";}else if(len%3==2){b64=b64.slice(0,-1)+"=";}
return b64;};F.string.base64DecodeUTF8=function(b64){var b64ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var str="",len=0,unit="",b=0;b64=b64.replace(/[^\d\w\+\/]/g,"");len=b64.length;for(var i=0;i<len;i++){b=b64ch.indexOf(b64.charAt(i))<<18;b|=b64ch.indexOf(b64.charAt(++i))<<12;b|=b64ch.indexOf(b64.charAt(++i))<<6;b|=b64ch.indexOf(b64.charAt(++i));unit=(b|0x1000000).toString(16);str+="%"+unit.substr(1,2)
str+="%"+unit.substr(3,2)
str+="%"+unit.substr(5,2);}
if(len%4){str=str.slice(0,(len%4-4)*3);}
return decodeURIComponent(str);};F.string.base64EncodeUTF16=function(str){var b64ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");var b64="",b=[],len=str.length;for(var i=0;i<len;i++){b[0]=str.charCodeAt(i)<<8;b[1]=str.charCodeAt(++i);b[0]|=b[1]>>>8;b[1]=b[1]<<16&0xFF0000|str.charCodeAt(++i);b64+=b64ch[b[0]>>>18];b64+=b64ch[b[0]>>>12&0x3F];b64+=b64ch[b[0]>>>6&0x3F];b64+=b64ch[b[0]&0x3F];b64+=b64ch[b[1]>>>18];b64+=b64ch[b[1]>>>12&0x3F];b64+=b64ch[b[1]>>>6&0x3F];b64+=b64ch[b[1]&0x3F];}
if(len%3==1){b64=b64.slice(0,-5)+"=";}else if(len%3==2){b64=b64.slice(0,-2)+"==";}
return b64;};F.string.base64DecodeUTF16=function(b64){var b64ch="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var str=unit=ch="",len=loop=b=0;b64=b64.replace(/[^\d\w\+\/]/g,"");len=b64.length;for(var i=0;i<len;i++){b=b64ch.indexOf(b64.charAt(i))<<18;b|=b64ch.indexOf(b64.charAt(++i))<<12;b|=b64ch.indexOf(b64.charAt(++i))<<6;b|=b64ch.indexOf(b64.charAt(++i));unit=(b|0x1000000).toString(16);if(ch&&i<len){str+="%u"+ch+unit.substr(1,2)
str+="%u"+unit.substr(3,4);ch="";}else if(ch){str+="%u"+ch+unit.substr(1,2)}else{str+="%u"+unit.substr(1,4);ch=unit.substr(5,2);}}
return unescape(str);};F.namespace('F.number');F.number.pad=function(source,length){var pre="",negative=(source<0),string=String(Math.abs(source));if(string.length<length){pre=(new Array(length-string.length+1)).join('0');}
return(negative?"-":"")+pre+string;};F.namespace('F.date');F.date.format=function(source,pattern){if('string'!=typeof pattern){return source.toString();}
function replacer(patternPart,result){pattern=pattern.replace(patternPart,result);}
var pad=F.number.pad,year=source.getFullYear(),month=source.getMonth()+1,date2=source.getDate(),hours=source.getHours(),minutes=source.getMinutes(),seconds=source.getSeconds();replacer(/yyyy/g,pad(year,4));replacer(/yy/g,pad(parseInt(year.toString().slice(2),10),2));replacer(/MM/g,pad(month,2));replacer(/M/g,month);replacer(/dd/g,pad(date2,2));replacer(/d/g,date2);replacer(/HH/g,pad(hours,2));replacer(/H/g,hours);replacer(/hh/g,pad(hours%12,2));replacer(/h/g,hours%12);replacer(/mm/g,pad(minutes,2));replacer(/m/g,minutes);replacer(/ss/g,pad(seconds,2));replacer(/s/g,seconds);return pattern;};F.date.toISOString=function(date){var date=date||new Date();return F.date.format(date,'yyyy-MM-dd HH:mm:ss');};F.date.unixTime=function(date){date=date||new Date();return Math.ceil(date.getTime()/1000);};F.date.fromUnixTime=function(time){time=parseInt(time);return new Date(time*1000);};var JSON;if(!JSON){JSON={};}
(function(){"use strict";function f(n){return n<10?'0'+n:n;}
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}
return str('',{'':value});};}
if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+
('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');};}}());F.json=JSON;F.namespace('F.session');F.session.get=function(name){return Session(name);};F.session.set=function(name,value){Session(name)=value;};F.session.remove=function(name){if(name!==undefined){Session.Contents.Remove(name);}else{Session.Contents.RemoveAll();}};F.session.each=function(fn){var s=new Enumerator(Session.Contents);for(;!s.atEnd();s.moveNext()){var k=s.item();fn.call(null,k,Session(k));}};F.namespace('F.ajax');F.ajax.load=function(method,url,fn,type,data){var http=xml_http();http.onreadystatechange=function(){if(http.readyState==4&&http.status===200){var types={'xml':'responseXML','text':'responseText','body':'responseBody','stream':'responseStream'};type=type||'text';fn(http[types[type]]);http=null;}}
http.open(method,url,false);http.send(data?data:null);function xml_http(){var xv=[".6.0",".5.0",".4.0",".3.0",".2.6",""];for(var i=0;i<xv.length;i++){try{return new ActiveXObject("msxml2.xmlHttp"+xv[i]);}catch(ex){}}}};F.ajax.get=function(url,fn,type){F.ajax.load('GET',url,fn,type);};F.namespace('F.cache');F.cache.set=function(name,value){Application.Lock();Application(name)=value;Application.UnLock();};F.cache.get=function(name){var value=Application(name);return value;};F.cache.remove=function(name){Application.Lock();if(name){Application.Contents.Remove(name);}else{Application.Contents.RemoveAll();}
Application.UnLock();};F.cache.each=function(fn){var s=new Enumerator(Application.Contents);for(;!s.atEnd();s.moveNext()){var k=s.item();fn.call(null,k,Application(k));}};F.cache._path='cache';F.cache._file=null;F.cache.getFileText=function(){var file=this._getFileObject();if(file.exist()){return file.getText();}
return null;};F.cache.setFileText=function(key,html){if(html===undefined){html=key;key=undefined;}
var file=this._getFileObject(key);file.setText(html);};F.cache.removeFile=function(key){var file=this._getFileObject(key);file.remove();};F.cache.existFile=function(key){var file=this._getFileObject(key);return file.exist();};F.cache.time=function(key){var file=this._getFileObject(key);return new Date(file.fso.GetFile(file.path).DateLastModified);};F.cache.removeAllFiles=function(){var file=new F.File();file.fso.DeleteFolder(server.MapPath(F.cache._path),true);file.fso.CreateFolder(server.MapPath(F.cache._path));};F.cache._getFileObject=function(key){if(!this._file){var fileKey=key===undefined?F.string.base64Encode(F.server('QUERY_STRING')):key;this._file=new F.File(F.cache._path+'/'+fileKey);}
return this._file;};F.cache.eachFile=function(fn){var folder=new F.Folder(F.cache._path);folder.files().forEach(function(file){fn.call(file,file);});};F.namespace('F.cookie');F.cookie.get=function(name){var cookie=Request.Cookies(name),value;if(cookie.HasKeys){value={};for(var i=1,len=cookie.Count;i<=len;i++){value[cookie.Key(i)]=cookie.Item(i);}
return value;}else{return cookie.Item;}};F.cookie.set=function(name,value,expires,domain,path,secure){if("string"===typeof value){Response.Cookies(name)=value;}else{for(var i in value){if(Object.hasOwnProperty.call(value,i)){Response.Cookies(name)(i)=value[i];}}}
if(expires){var date=expires;Response.Cookies(name).Expires=(date.getMonth()+1)+'/'+date.getDate()+'/'+date.getFullYear()+' '+
date.getHours()+':'+date.getMinutes()+':'+
date.getSeconds();}
domain&&(Response.Cookies(name).Domain=domain);path&&(Response.Cookies(name).Path=path);secure&&(Response.Cookies(name).Secure=secure);};F.cookie.remove=function(name){if(name){Response.Cookies(name).Expires="8/4/1985";}else{for(var i=1,len=Request.Cookies.Count;i<=len;i++){Response.Cookies.Item(i).Expires="8/4/1985";}}};F.cookie.each=function(fn){var s=new Enumerator(Request.Cookies);for(;!s.atEnd();s.moveNext()){var k=s.item();fn.call(null,k,F.cookie.get(k));}};F.Connection=function(){F.Connection.last=this;this._connectionString='';this._connection=null;this._isOpen=false;};F.Connection.last=null;F.Connection.prototype={isOpen:function(){return this._isOpen;},open:function(){try{this._connection=new ActiveXObject("ADODB.Connection");this._connection.ConnectionString=this._connectionString;this._connection.Open();this._isOpen=true;return this;}catch(e){throw new Error('Connection open Error!');}},close:function(){try{this._connection.Close();this._connection=null;this._isOpen=false;return this;}catch(e){throw new Error('Connection close Error!');}},model:function(tableName){return new F.Model(tableName,this);},execute:function(sql){try{return this._connection.Execute(sql);}catch(e){e.sql=sql;throw e;}},executeScalar:function(sql){var rs=this.getRecordSet(sql),r;if(!rs.Eof){r=rs(0).Value;rs.Close();}else{throw new Error('No Result.');}
return r;},beginTrans:function(){this._connection.BeginTrans();},rollBackTrans:function(){this._connection.RollBackTrans();},commitTrans:function(){this._connection.CommitTrans();},getRecordSet:function(sql,cursorType,lockType){cursorType=cursorType||1;lockType=lockType||1;var rs=new ActiveXObject("ADODB.RecordSet");rs.Open(sql,this._connection,cursorType,lockType);return rs;},getJson:function(rs){if(typeof rs=='string'){rs=this.getRecordSet(rs);}
var fieldsCount=rs.Fields.Count;var json=[],fields=[];for(var i=0;i<fieldsCount;i++){fields.push(rs.Fields(i).Name);}
var l=fields.length;while(!rs.Eof){var row={};for(var i=0;i<l;i++){row[fields[i]]=rs(fields[i]).Value;}
json.push(row);rs.MoveNext();}
rs.Close();return json;},insert:function(tableName,values){var rs=this.getRecordSet('select * from '+tableName+' where 1=2;',1,2);rs.AddNew();for(var i in values){rs(i)=values[i];}
rs.Update();rs.Close();},update:function(rs,values){if(typeof rs=='string'){rs=this.getRecordSet(rs,2,3);}
while(!rs.Eof){for(var i in values){rs(i)=values[i];}
rs.Update();rs.MoveNext();}
rs.Close();},tableNames:function(schemaName){return this.getSchemaNames('TABLE',20,schemaName);},viewNames:function(schemaName){return this.getSchemaNames('VIEW',20,schemaName);},getHtmlTable:function(rs,opt){opt=opt||{};var cols=opt.cols||[];if(typeof rs=='string'){rs=this.execute(rs);}
var html=['<table cellspacing="0"',opt.attr&&(' '+opt.attr)||'','>\n'];var fields=[];for(var e=new Enumerator(rs.Fields);!e.atEnd();e.moveNext()){fields.push(e.item().Name);}
if(opt.caption){html.push('<caption>'+opt.caption+'</caption>\n');}
if(!opt.nohead){html.push('<tr>\n');for(var i=0;i<fields.length;i++){html.push('<th>',fields[i],'</th>\n');}
for(var i=0;i<cols.length;i++){html.push('<th>',cols[i].th,'</th>\n');}}
html.push('</tr>\n');var rowIndex=0,fieldsLength=fields.length,temp={},i,columnCount=fieldsLength+cols.length;while(!rs.Eof){rowIndex++;html.push('<tr>');for(i=0;i<fieldsLength;i++){var value=rs(fields[i]).Value;switch(typeof value){case'object':if(!value){value='[Null]';}else{value='[Object]';}
break;case'date':value=new Date(value).toLocaleString();break;case'string':value=value.length==0?'[Empty]':F.encodeHTML(value.length>50?value.substr(0,50)+'...':value);break;case'unkonwn':value='[Binary]';break;case'number':value=String(value);break;}
html.push('<td>',value,'</td>\n');temp[fields[i]]=value;}
for(i=0;i<cols.length;i++){html.push('<td>',typeof cols[i]['td']==='function'?cols[i]['td'](temp):cols[i]['td'],'</td>\n');}
html.push('</tr>\n');if(rowIndex>999){break;}
rs.MoveNext();}
rs.Close();if(rowIndex===0){html.push('<tr><td colspan="'+columnCount+'">',opt.emptyString||'没有数据','</td><tr>');}
html.push('</table>');return html.join('');},getSchemaNames:function(type,queryType,schemaName){var names=[];var constraints=[];if(schemaName)constraints[1]=schemaName;constraints[3]=type;var rs=this.getSchema(queryType,constraints);while(!rs.Eof){names.push(rs(2).Value);rs.MoveNext();}
rs.Close();return names;},getSchema:function(queryType,constraints){return this._connection.OpenSchema(queryType,constraints);},getSchemaHtml:function(queryType,constraints){return this.getHtmlTable(this.getSchema(queryType,constraints),{attr:'border=1'});},sourceSql:function(fileName){var f=new F.File(fileName);var conn=this._connection;f.forEachLine(function(sql){sql&&conn.execute(sql.replace(/__RN__/g,'\n'));});},getTypeString:function(adoType,flags){var map={11:'BOOLEAN',128:'BINARY',129:'VARCHAR',130:'VARCHAR',131:'DECIMAL',133:'DATETIME',134:'DATETIME',135:'DATETIME',137:'DATETIME',139:'DECIMAL',14:'DECIMAL',16:'TINYINT',17:'SMALLINT',18:'SMALLINT',19:'INTEGER',200:'VARCHAR',201:'TEXT',202:'VARCHAR',203:'TEXT',20:'INTEGER',21:'INTEGER',2:'SMALLINT',3:'INTEGER',4:'REAL',5:'FLOAT',64:'DATETIME',6:'FLOAT',7:'DATETIME',72:'UNIQUEIDENTIFIER'};var t=map[adoType];if(t==='VARCHAR'&&flags===234){t='TEXT';}else if(flags===90&&adoType===3){t='AUTOINCREMENT';}
return t||'TEXT';}};F.ExcelConnection=function(dataPath,hasHeader){F.Connection.call(this);this._hasHeader=hasHeader;this._dataSource=Server.MapPath(dataPath);this._connectionString='Provider=Microsoft.Jet.OLEDB.4.0; '+'Data source='+this._dataSource+'; '+'User Id=admin; Password=; '+'Extended Properties="Excel 8.0;HDR='+(this.header?'Yes':'No')+'";';};F.inherits(F.ExcelConnection,F.Connection);F.MsJetConnection=function(dataPath){F.Connection.call(this);this._dataSource=Server.MapPath(dataPath);this._connectionString="Provider=Microsoft.Jet.OLEDB.4.0; "+"Data source="+this._dataSource+"; "+"User Id=admin; Password=;";};F.inherits(F.MsJetConnection,F.Connection);F.MsJetConnection.prototype.repair=function(){var needOpen=false;if(this._isOpen){needOpen=true;this.close();}
var engine=new ActiveXObject("JRO.JetEngine");var fso=F.fso();var mdb=this._dataSource;var tmp=mdb+".tmp";var bak=mdb+".bak";fso.CopyFile(mdb,bak);if(fso.FileExists(tmp))fso.DeleteFile(tmp);engine.CompactDatabase("Provider=Microsoft.Jet.OLEDB.4.0; Data source="+mdb+"; User Id=admin; Password=;","Provider=Microsoft.Jet.OLEDB.4.0; Data source="+tmp+"; User Id=admin; Password=;");if(fso.FileExists(mdb))fso.DeleteFile(mdb);fso.MoveFile(tmp,mdb);fso=null;engine=null;if(needOpen){this.open();}};F.MsSqlConnection=function(dataSource,initialCatalog,userId,password){F.Connection.call(this);this._connectionString="Provider=SQLOLEDB; "+"Data Source="+dataSource+"; "+"Initial Catalog="+initialCatalog+"; "+"User Id="+userId+"; "+"Password="+password+";";};F.inherits(F.MsSqlConnection,F.Connection);F.MsSqlConnection.prototype.getTypeString=function(adoType,flags){};F.File=function(filename){this.path='';if(F.isString(filename)){this.setPath(filename);}};F.File.prototype={fso:function(){return new ActiveXObject('Scripting.FileSystemObject');},getFileName:function(){return this.fso().GetFileName(this.path);},getFileType:function(){if(!this.exist()){debug(arguments,this);}
var o=new ActiveXObject("ADODB.Stream")
o.Type=2;o.Mode=3;o.CharSet='iso-8859-15';o.Open();o.LoadFromFile(this.path);o.Position=0;var s=o.ReadText(20),t={},pid="";o.Close();o=null;if((pid=s.substr(0,2))=="BM"){t.type="bmp";}else if(pid=="MZ"){t.type="exe";t.format="pe";}else if(pid=="PK"){t.type="zip";}else if((pid=s.substr(0,3))=="GIF"){t.type="gif";}else if(pid=="II*"){t.type="tif";}else if(pid=="CWS"||pid=="FWS"){t.type="swf";t.format=pid.toLowerCase();}else if(pid=="ID3"){t.type="mp3";}else if((pid=s.substr(0,4))=="\x89PNG"){t.type="png";}else if(pid=="RIFF"){t.type="wav";}else if(pid=="ITSF"){t.type="chm";}else if(pid=="\x25PDF"){t.type="pdf";}else if(pid=="Rar\x21"){t.type="rar";}else if(s.substr(6,4)=="JFIF"){t.type="jpg";t.format="jfif";}else if(pid=="\xFF\xD8\xFF\xE1"){t.type="jpg";}else if(pid==".RMF"){t.type="rm";}else if(pid=="0\x26\xB2u"){t.type="wma";}else if(s.substr(4,12)=="Standard Jet"){t.type="mdb";}else if(s.substr(0,12)=="\xD0\xCF\x11\xE0\xA1\xB1\x1A\xE1\x00\x00\x00\x00"){t.type="mso";}else if(s.substr(2,3)=="AMR"){t.type="amr";}else if(s.substr(0,3)=="\xEF\xBB\xBF"){t.type="txt";t.format="utf-8";}else if((pid=s.substr(0,2))=="\xFF\xFE"){t.type="txt";t.format="utf-16le";}else if(pid=="\xFE\xFF"){t.type="txt";t.format="utf-16be";}else if(s.substr(0,4)=="\x84\x31\x95\x33"){t.type="txt";t.format="gb18030";}else{t.type="unkonwn";}
return t;},getMime:function(){var t=this.getFileType();if(t.type in F.File.Mimes){return F.File.Mimes[t.type];}
return'application/unknown';},send:function(){F.header('Content-Disposition','attachment;filename='+this.getFileName());F.header('Content-Length',this.getSize());F.header('Content-Type',this.getMime());Response.BinaryWrite(this.getBinary());Response.Flush();Response.Clear();},getSize:function(){return this.fso().GetFile(this.path).Size;},getDateCreated:function(){var f=this.fso().GetFile(this.path);return new Date(f.DateCreated);},getDateLastAccessed:function(){var f=this.fso().GetFile(this.path);return new Date(f.DateLastAccessed);},getDateLastModified:function(){var f=this.fso().GetFile(this.path);return new Date(f.DateLastModified);},getDate:function(){var f=this.fso().GetFile(this.path);return{'DateCreated':new Date(f.DateCreated),'DateLastAccessed':new Date(f.DateLastAccessed),'DateLastModified':new Date(f.DateLastModified)};},getInfo:function(){var f=this.fso().GetFile(this.path);return{'DateCreated':new Date(f.DateCreated),'DateLastAccessed':new Date(f.DateLastAccessed),'DateLastModified':new Date(f.DateLastModified),'DriveVolumeName':f.Drive.VolumeName,'DriveLetter':f.Drive.DriveLetter,'IsRootFolder':Boolean(f.IsRootFolder),'Name':f.Name,'ParentFolder':String(f.ParentFolder),'Path':f.Path,'ShortName':f.ShortName,'ShortPath':f.ShortPath,'Size':f.Size,'Type':f.Type}},getText:function(charset){if(!this.exist()){debug(arguments,this);}
var s=new ActiveXObject("ADODB.Stream"),str;s.Type=2;s.CharSet=charset||'utf-8';s.Open();s.LoadFromFile(this.path);str=s.ReadText();s.Close();s=null;return str;},getBinary:function(){if(!this.exist()){debug(arguments,this);}
var content;var s=new ActiveXObject("ADODB.Stream");s.Type=1;s.Open();s.LoadFromFile(this.path);content=s.Read();s.Close();s=null;return content;},getBase64String:function(){var xml=new ActiveXObject('Microsoft.XMLDOM');xml.loadXML('<r xmlns:dt="urn:schemas-microsoft-com:datatypes"><e dt:dt="bin.base64"></e></r>');var f=xml.documentElement.selectSingleNode('e');f.nodeTypedValue=this.getBinary();return f.text;},setText:function(text,charset){var s=new ActiveXObject("ADODB.Stream");s.Type=2;s.Charset=charset||'utf-8';s.Open();s.WriteText(text);s.SaveToFile(this.path,2);s.Close();s=null;return this;},setBinary:function(content){var s=new ActiveXObject("ADODB.Stream");s.Type=1;s.Open();s.Write(content);s.SaveToFile(this.path,2);s.Close();s=null;return this;},setBase64String:function(str64){var xml=new ActiveXObject('Microsoft.XMLDOM');xml.loadXML('<r xmlns:dt="urn:schemas-microsoft-com:datatypes"><e dt:dt="bin.base64"></e></r>');var f=xml.documentElement.selectSingleNode('e');f.text=str64;this.setBinary(f.nodeTypedValue);f=null;xml=null;return this;},create:function(content){var folder=this.getFolder();if(!folder.exist()){folder.create();}
var f=this.fso().CreateTextFile(this.path,true);if(content!==undefined){f.WriteLine(content);}
f.Close();return this;},getFolder:function(){return new F.Folder(this.path.replace(/(\\|\/)[^\\\/]+$/,''));},appendText:function(text,charset){var s=new ActiveXObject("ADODB.Stream");s.Type=2;s.CharSet=charset||'utf-8';s.Open();s.LoadFromFile(this.path);s.Position=s.Size;s.WriteText(text);s.SaveToFile(this.path,2);s.Close();s=null;return this;},getTextPart:function(start,end,charset){var s=new ActiveXObject("ADODB.Stream"),str;s.Type=2;s.CharSet=charset||'utf-8';s.Open();s.LoadFromFile(this.path);s.Position=start;str=s.ReadText(end-start);s.Close();s=null;return str;},forEachLine:function(fn,charset){charset=charset||'utf-8';var s=new ActiveXObject("ADODB.Stream");s.Type=2;s.CharSet=charset;s.Open();s.LoadFromFile(this.path);var temp,arr,step=5000;var ext='';while(temp=s.ReadText(step)){arr=(ext+temp).split('\n');ext=arr.pop();arr.forEach(fn);}
s.Close();s=null;},setPath:function(path){this.path=(path.indexOf(':')>-1)?path:Server.MapPath(path);return this;},exist:function(path){return this.fso().FileExists(path||this.path);},remove:function(path){this.fso().DeleteFile(path||this.path,true);return this;},rename:function(name){name=name.trim();if(name!==''&&this.getFileName()!==name){var f=this.fso().getFile(this.path);f.Name=name;this.path=f.Path;}
return this;},getExtensionName:function(path){return this.fso().GetExtensionName(path||this.path);},dispose:function(){this.path=null;}};F.File.Mimes={"123":"application/vnd.lotus-1-2-3","3dml":"text/vnd.in3d.3dml","3g2":"video/3gpp2","3gp":"video/3gpp","aab":"application/x-authorware-bin","aac":"audio/x-aac","aam":"application/x-authorware-map","aas":"application/x-authorware-seg","abw":"application/x-abiword","acc":"application/vnd.americandynamics.acc","ace":"application/x-ace-compressed","acu":"application/vnd.acucobol","acutc":"application/vnd.acucorp","adp":"audio/adpcm","aep":"application/vnd.audiograph","afm":"application/x-font-type1","afp":"application/vnd.ibm.modcap","ai":"application/postscript","aif":"audio/x-aiff","aifc":"audio/x-aiff","aiff":"audio/x-aiff","air":"application/vnd.adobe.air-application-installer-package+zip","ami":"application/vnd.amiga.ami","apk":"application/vnd.android.package-archive","application":"application/x-ms-application","apr":"application/vnd.lotus-approach","asc":"application/pgp-signature","asf":"video/x-ms-asf","asm":"text/x-asm","aso":"application/vnd.accpac.simply.aso","asx":"video/x-ms-asf","atc":"application/vnd.acucorp","atom":"application/atom+xml","atomcat":"application/atomcat+xml","atomsvc":"application/atomsvc+xml","atx":"application/vnd.antix.game-component","au":"audio/basic","avi":"video/x-msvideo","aw":"application/applixware","azf":"application/vnd.airzip.filesecure.azf","azs":"application/vnd.airzip.filesecure.azs","azw":"application/vnd.amazon.ebook","bat":"application/x-msdownload","bcpio":"application/x-bcpio","bdf":"application/x-font-bdf","bdm":"application/vnd.syncml.dm+wbxml","bh2":"application/vnd.fujitsu.oasysprs","bin":"application/octet-stream","bmi":"application/vnd.bmi","bmp":"image/bmp","book":"application/vnd.framemaker","box":"application/vnd.previewsystems.box","boz":"application/x-bzip2","bpk":"application/octet-stream","btif":"image/prs.btif","bz":"application/x-bzip","bz2":"application/x-bzip2","c":"text/x-c","c4d":"application/vnd.clonk.c4group","c4f":"application/vnd.clonk.c4group","c4g":"application/vnd.clonk.c4group","c4p":"application/vnd.clonk.c4group","c4u":"application/vnd.clonk.c4group","cab":"application/vnd.ms-cab-compressed","car":"application/vnd.curl.car","cat":"application/vnd.ms-pki.seccat","cc":"text/x-c","cct":"application/x-director","ccxml":"application/ccxml+xml","cdbcmsg":"application/vnd.contact.cmsg","cdf":"application/x-netcdf","cdkey":"application/vnd.mediastation.cdkey","cdx":"chemical/x-cdx","cdxml":"application/vnd.chemdraw+xml","cdy":"application/vnd.cinderella","cer":"application/pkix-cert","cgm":"image/cgm","chat":"application/x-chat","chm":"application/vnd.ms-htmlhelp","chrt":"application/vnd.kde.kchart","cif":"chemical/x-cif","cii":"application/vnd.anser-web-certificate-issue-initiation","cil":"application/vnd.ms-artgalry","cla":"application/vnd.claymore","class":"application/java-vm","clkk":"application/vnd.crick.clicker.keyboard","clkp":"application/vnd.crick.clicker.palette","clkt":"application/vnd.crick.clicker.template","clkw":"application/vnd.crick.clicker.wordbank","clkx":"application/vnd.crick.clicker","clp":"application/x-msclip","cmc":"application/vnd.cosmocaller","cmdf":"chemical/x-cmdf","cml":"chemical/x-cml","cmp":"application/vnd.yellowriver-custom-menu","cmx":"image/x-cmx","cod":"application/vnd.rim.cod","com":"application/x-msdownload","conf":"text/plain","cpio":"application/x-cpio","cpp":"text/x-c","cpt":"application/mac-compactpro","crd":"application/x-mscardfile","crl":"application/pkix-crl","crt":"application/x-x509-ca-cert","csh":"application/x-csh","csml":"chemical/x-csml","csp":"application/vnd.commonspace","css":"text/css","cst":"application/x-director","csv":"text/csv","cu":"application/cu-seeme","curl":"text/vnd.curl","cww":"application/prs.cww","cxt":"application/x-director","cxx":"text/x-c","daf":"application/vnd.mobius.daf","dataless":"application/vnd.fdsn.seed","davmount":"application/davmount+xml","dcr":"application/x-director","dcurl":"text/vnd.curl.dcurl","dd2":"application/vnd.oma.dd2+xml","ddd":"application/vnd.fujixerox.ddd","deb":"application/x-debian-package","def":"text/plain","deploy":"application/octet-stream","der":"application/x-x509-ca-cert","dfac":"application/vnd.dreamfactory","dic":"text/x-c","dir":"application/x-director","dis":"application/vnd.mobius.dis","dist":"application/octet-stream","distz":"application/octet-stream","djv":"image/vnd.djvu","djvu":"image/vnd.djvu","dll":"application/x-msdownload","dmg":"application/octet-stream","dms":"application/octet-stream","dna":"application/vnd.dna","doc":"application/msword","docm":"application/vnd.ms-word.document.macroenabled.12","docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","dot":"application/msword","dotm":"application/vnd.ms-word.template.macroenabled.12","dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template","dp":"application/vnd.osgi.dp","dpg":"application/vnd.dpgraph","dsc":"text/prs.lines.tag","dtb":"application/x-dtbook+xml","dtd":"application/xml-dtd","dts":"audio/vnd.dts","dtshd":"audio/vnd.dts.hd","dump":"application/octet-stream","dvi":"application/x-dvi","dwf":"model/vnd.dwf","dwg":"image/vnd.dwg","dxf":"image/vnd.dxf","dxp":"application/vnd.spotfire.dxp","dxr":"application/x-director","ecelp4800":"audio/vnd.nuera.ecelp4800","ecelp7470":"audio/vnd.nuera.ecelp7470","ecelp9600":"audio/vnd.nuera.ecelp9600","ecma":"application/ecmascript","edm":"application/vnd.novadigm.edm","edx":"application/vnd.novadigm.edx","efif":"application/vnd.picsel","ei6":"application/vnd.pg.osasli","elc":"application/octet-stream","eml":"message/rfc822","emma":"application/emma+xml","eol":"audio/vnd.digital-winds","eot":"application/vnd.ms-fontobject","eps":"application/postscript","epub":"application/epub+zip","es3":"application/vnd.eszigno3+xml","esf":"application/vnd.epson.esf","et3":"application/vnd.eszigno3+xml","etx":"text/x-setext","exe":"application/x-msdownload","ext":"application/vnd.novadigm.ext","ez":"application/andrew-inset","ez2":"application/vnd.ezpix-album","ez3":"application/vnd.ezpix-package","f":"text/x-fortran","f4v":"video/x-f4v","f77":"text/x-fortran","f90":"text/x-fortran","fbs":"image/vnd.fastbidsheet","fdf":"application/vnd.fdf","fe_launch":"application/vnd.denovo.fcselayout-link","fg5":"application/vnd.fujitsu.oasysgp","fgd":"application/x-director","fh":"image/x-freehand","fh4":"image/x-freehand","fh5":"image/x-freehand","fh7":"image/x-freehand","fhc":"image/x-freehand","fig":"application/x-xfig","fli":"video/x-fli","flo":"application/vnd.micrografx.flo","flv":"video/x-flv","flw":"application/vnd.kde.kivio","flx":"text/vnd.fmi.flexstor","fly":"text/vnd.fly","fm":"application/vnd.framemaker","fnc":"application/vnd.frogans.fnc","for":"text/x-fortran","fpx":"image/vnd.fpx","frame":"application/vnd.framemaker","fsc":"application/vnd.fsc.weblaunch","fst":"image/vnd.fst","ftc":"application/vnd.fluxtime.clip","fti":"application/vnd.anser-web-funds-transfer-initiation","fvt":"video/vnd.fvt","fzs":"application/vnd.fuzzysheet","g3":"image/g3fax","gac":"application/vnd.groove-account","gdl":"model/vnd.gdl","geo":"application/vnd.dynageo","gex":"application/vnd.geometry-explorer","ggb":"application/vnd.geogebra.file","ggt":"application/vnd.geogebra.tool","ghf":"application/vnd.groove-help","gif":"image/gif","gim":"application/vnd.groove-identity-message","gmx":"application/vnd.gmx","gnumeric":"application/x-gnumeric","gph":"application/vnd.flographit","gqf":"application/vnd.grafeq","gqs":"application/vnd.grafeq","gram":"application/srgs","gre":"application/vnd.geometry-explorer","grv":"application/vnd.groove-injector","grxml":"application/srgs+xml","gsf":"application/x-font-ghostscript","gtar":"application/x-gtar","gtm":"application/vnd.groove-tool-message","gtw":"model/vnd.gtw","gv":"text/vnd.graphviz","h":"text/x-c","h261":"video/h261","h263":"video/h263","h264":"video/h264","hbci":"application/vnd.hbci","hdf":"application/x-hdf","hh":"text/x-c","hlp":"application/winhlp","hpgl":"application/vnd.hp-hpgl","hpid":"application/vnd.hp-hpid","hps":"application/vnd.hp-hps","hqx":"application/mac-binhex40","htke":"application/vnd.kenameaapp","htm":"text/html","html":"text/html","hvd":"application/vnd.yamaha.hv-dic","hvp":"application/vnd.yamaha.hv-voice","hvs":"application/vnd.yamaha.hv-script","icc":"application/vnd.iccprofile","ice":"x-conference/x-cooltalk","icm":"application/vnd.iccprofile","ico":"image/x-icon","ics":"text/calendar","ief":"image/ief","ifb":"text/calendar","ifm":"application/vnd.shana.informed.formdata","iges":"model/iges","igl":"application/vnd.igloader","igs":"model/iges","igx":"application/vnd.micrografx.igx","iif":"application/vnd.shana.informed.interchange","imp":"application/vnd.accpac.simply.imp","ims":"application/vnd.ms-ims","in":"text/plain","ipk":"application/vnd.shana.informed.package","irm":"application/vnd.ibm.rights-management","irp":"application/vnd.irepository.package+xml","iso":"application/octet-stream","itp":"application/vnd.shana.informed.formtemplate","ivp":"application/vnd.immervision-ivp","ivu":"application/vnd.immervision-ivu","jad":"text/vnd.sun.j2me.app-descriptor","jam":"application/vnd.jam","jar":"application/java-archive","java":"text/x-java-source","jisp":"application/vnd.jisp","jlt":"application/vnd.hp-jlyt","jnlp":"application/x-java-jnlp-file","joda":"application/vnd.joost.joda-archive","jpe":"image/jpeg","jpeg":"image/jpeg","jpg":"image/jpeg","jpgm":"video/jpm","jpgv":"video/jpeg","jpm":"video/jpm","js":"application/javascript","json":"application/json","kar":"audio/midi","karbon":"application/vnd.kde.karbon","kfo":"application/vnd.kde.kformula","kia":"application/vnd.kidspiration","kml":"application/vnd.google-earth.kml+xml","kmz":"application/vnd.google-earth.kmz","kne":"application/vnd.kinar","knp":"application/vnd.kinar","kon":"application/vnd.kde.kontour","kpr":"application/vnd.kde.kpresenter","kpt":"application/vnd.kde.kpresenter","ksp":"application/vnd.kde.kspread","ktr":"application/vnd.kahootz","ktz":"application/vnd.kahootz","kwd":"application/vnd.kde.kword","kwt":"application/vnd.kde.kword","latex":"application/x-latex","lbd":"application/vnd.llamagraphics.life-balance.desktop","lbe":"application/vnd.llamagraphics.life-balance.exchange+xml","les":"application/vnd.hhe.lesson-player","lha":"application/octet-stream","link66":"application/vnd.route66.link66+xml","list":"text/plain","list3820":"application/vnd.ibm.modcap","listafp":"application/vnd.ibm.modcap","log":"text/plain","lostxml":"application/lost+xml","lrf":"application/octet-stream","lrm":"application/vnd.ms-lrm","ltf":"application/vnd.frogans.ltf","lvp":"audio/vnd.lucent.voice","lwp":"application/vnd.lotus-wordpro","lzh":"application/octet-stream","m13":"application/x-msmediaview","m14":"application/x-msmediaview","m1v":"video/mpeg","m2a":"audio/mpeg","m2v":"video/mpeg","m3a":"audio/mpeg","m3u":"audio/x-mpegurl","m4u":"video/vnd.mpegurl","m4v":"video/x-m4v","ma":"application/mathematica","mag":"application/vnd.ecowin.chart","maker":"application/vnd.framemaker","man":"text/troff","mathml":"application/mathml+xml","mb":"application/mathematica","mbk":"application/vnd.mobius.mbk","mbox":"application/mbox","mc1":"application/vnd.medcalcdata","mcd":"application/vnd.mcd","mcurl":"text/vnd.curl.mcurl","mdb":"application/x-msaccess","mdi":"image/vnd.ms-modi","me":"text/troff","mesh":"model/mesh","mfm":"application/vnd.mfmp","mgz":"application/vnd.proteus.magazine","mid":"audio/midi","midi":"audio/midi","mif":"application/vnd.mif","mime":"message/rfc822","mj2":"video/mj2","mjp2":"video/mj2","mlp":"application/vnd.dolby.mlp","mmd":"application/vnd.chipnuts.karaoke-mmd","mmf":"application/vnd.smaf","mmr":"image/vnd.fujixerox.edmics-mmr","mny":"application/x-msmoney","mobi":"application/x-mobipocket-ebook","mov":"video/quicktime","movie":"video/x-sgi-movie","mp2":"audio/mpeg","mp2a":"audio/mpeg","mp3":"audio/mpeg","mp4":"video/mp4","mp4a":"audio/mp4","mp4s":"application/mp4","mp4v":"video/mp4","mpc":"application/vnd.mophun.certificate","mpe":"video/mpeg","mpeg":"video/mpeg","mpg":"video/mpeg","mpg4":"video/mp4","mpga":"audio/mpeg","mpkg":"application/vnd.apple.installer+xml","mpm":"application/vnd.blueice.multipass","mpn":"application/vnd.mophun.application","mpp":"application/vnd.ms-project","mpt":"application/vnd.ms-project","mpy":"application/vnd.ibm.minipay","mqy":"application/vnd.mobius.mqy","mrc":"application/marc","ms":"text/troff","mscml":"application/mediaservercontrol+xml","mseed":"application/vnd.fdsn.mseed","mseq":"application/vnd.mseq","msf":"application/vnd.epson.msf","msh":"model/mesh","msi":"application/x-msdownload","msl":"application/vnd.mobius.msl","msty":"application/vnd.muvee.style","mts":"model/vnd.mts","mus":"application/vnd.musician","musicxml":"application/vnd.recordare.musicxml+xml","mvb":"application/x-msmediaview","mwf":"application/vnd.mfer","mxf":"application/mxf","mxl":"application/vnd.recordare.musicxml","mxml":"application/xv+xml","mxs":"application/vnd.triscape.mxs","mxu":"video/vnd.mpegurl","n-gage":"application/vnd.nokia.n-gage.symbian.install","nb":"application/mathematica","nc":"application/x-netcdf","ncx":"application/x-dtbncx+xml","ngdat":"application/vnd.nokia.n-gage.data","nlu":"application/vnd.neurolanguage.nlu","nml":"application/vnd.enliven","nnd":"application/vnd.noblenet-directory","nns":"application/vnd.noblenet-sealer","nnw":"application/vnd.noblenet-web","npx":"image/vnd.net-fpx","nsf":"application/vnd.lotus-notes","oa2":"application/vnd.fujitsu.oasys2","oa3":"application/vnd.fujitsu.oasys3","oas":"application/vnd.fujitsu.oasys","obd":"application/x-msbinder","oda":"application/oda","odb":"application/vnd.oasis.opendocument.database","odc":"application/vnd.oasis.opendocument.chart","odf":"application/vnd.oasis.opendocument.formula","odft":"application/vnd.oasis.opendocument.formula-template","odg":"application/vnd.oasis.opendocument.graphics","odi":"application/vnd.oasis.opendocument.image","odp":"application/vnd.oasis.opendocument.presentation","ods":"application/vnd.oasis.opendocument.spreadsheet","odt":"application/vnd.oasis.opendocument.text","oga":"audio/ogg","ogg":"audio/ogg","ogv":"video/ogg","ogx":"application/ogg","onepkg":"application/onenote","onetmp":"application/onenote","onetoc":"application/onenote","onetoc2":"application/onenote","opf":"application/oebps-package+xml","oprc":"application/vnd.palm","org":"application/vnd.lotus-organizer","osf":"application/vnd.yamaha.openscoreformat","osfpvg":"application/vnd.yamaha.openscoreformat.osfpvg+xml","otc":"application/vnd.oasis.opendocument.chart-template","otf":"application/x-font-otf","otg":"application/vnd.oasis.opendocument.graphics-template","oth":"application/vnd.oasis.opendocument.text-web","oti":"application/vnd.oasis.opendocument.image-template","otm":"application/vnd.oasis.opendocument.text-master","otp":"application/vnd.oasis.opendocument.presentation-template","ots":"application/vnd.oasis.opendocument.spreadsheet-template","ott":"application/vnd.oasis.opendocument.text-template","oxt":"application/vnd.openofficeorg.extension","p":"text/x-pascal","p10":"application/pkcs10","p12":"application/x-pkcs12","p7b":"application/x-pkcs7-certificates","p7c":"application/pkcs7-mime","p7m":"application/pkcs7-mime","p7r":"application/x-pkcs7-certreqresp","p7s":"application/pkcs7-signature","pas":"text/x-pascal","pbd":"application/vnd.powerbuilder6","pbm":"image/x-portable-bitmap","pcf":"application/x-font-pcf","pcl":"application/vnd.hp-pcl","pclxl":"application/vnd.hp-pclxl","pct":"image/x-pict","pcurl":"application/vnd.curl.pcurl","pcx":"image/x-pcx","pdb":"application/vnd.palm","pdf":"application/pdf","pfa":"application/x-font-type1","pfb":"application/x-font-type1","pfm":"application/x-font-type1","pfr":"application/font-tdpfr","pfx":"application/x-pkcs12","pgm":"image/x-portable-graymap","pgn":"application/x-chess-pgn","pgp":"application/pgp-encrypted","pic":"image/x-pict","pkg":"application/octet-stream","pki":"application/pkixcmp","pkipath":"application/pkix-pkipath","plb":"application/vnd.3gpp.pic-bw-large","plc":"application/vnd.mobius.plc","plf":"application/vnd.pocketlearn","pls":"application/pls+xml","pml":"application/vnd.ctc-posml","png":"image/png","pnm":"image/x-portable-anymap","portpkg":"application/vnd.macports.portpkg","pot":"application/vnd.ms-powerpoint","potm":"application/vnd.ms-powerpoint.template.macroenabled.12","potx":"application/vnd.openxmlformats-officedocument.presentationml.template","ppam":"application/vnd.ms-powerpoint.addin.macroenabled.12","ppd":"application/vnd.cups-ppd","ppm":"image/x-portable-pixmap","pps":"application/vnd.ms-powerpoint","ppsm":"application/vnd.ms-powerpoint.slideshow.macroenabled.12","ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow","ppt":"application/vnd.ms-powerpoint","pptm":"application/vnd.ms-powerpoint.presentation.macroenabled.12","pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation","pqa":"application/vnd.palm","prc":"application/x-mobipocket-ebook","pre":"application/vnd.lotus-freelance","prf":"application/pics-rules","ps":"application/postscript","psb":"application/vnd.3gpp.pic-bw-small","psd":"image/vnd.adobe.photoshop","psf":"application/x-font-linux-psf","ptid":"application/vnd.pvi.ptid1","pub":"application/x-mspublisher","pvb":"application/vnd.3gpp.pic-bw-var","pwn":"application/vnd.3m.post-it-notes","pya":"audio/vnd.ms-playready.media.pya","pyv":"video/vnd.ms-playready.media.pyv","qam":"application/vnd.epson.quickanime","qbo":"application/vnd.intu.qbo","qfx":"application/vnd.intu.qfx","qps":"application/vnd.publishare-delta-tree","qt":"video/quicktime","qwd":"application/vnd.quark.quarkxpress","qwt":"application/vnd.quark.quarkxpress","qxb":"application/vnd.quark.quarkxpress","qxd":"application/vnd.quark.quarkxpress","qxl":"application/vnd.quark.quarkxpress","qxt":"application/vnd.quark.quarkxpress","ra":"audio/x-pn-realaudio","ram":"audio/x-pn-realaudio","rar":"application/x-rar-compressed","ras":"image/x-cmu-raster","rcprofile":"application/vnd.ipunplugged.rcprofile","rdf":"application/rdf+xml","rdz":"application/vnd.data-vision.rdz","rep":"application/vnd.businessobjects","res":"application/x-dtbresource+xml","rgb":"image/x-rgb","rif":"application/reginfo+xml","rl":"application/resource-lists+xml","rlc":"image/vnd.fujixerox.edmics-rlc","rld":"application/resource-lists-diff+xml","rm":"application/vnd.rn-realmedia","rmi":"audio/midi","rmp":"audio/x-pn-realaudio-plugin","rms":"application/vnd.jcp.javame.midlet-rms","rnc":"application/relax-ng-compact-syntax","roff":"text/troff","rpss":"application/vnd.nokia.radio-presets","rpst":"application/vnd.nokia.radio-preset","rq":"application/sparql-query","rs":"application/rls-services+xml","rsd":"application/rsd+xml","rss":"application/rss+xml","rtf":"application/rtf","rtx":"text/richtext","s":"text/x-asm","saf":"application/vnd.yamaha.smaf-audio","sbml":"application/sbml+xml","sc":"application/vnd.ibm.secure-container","scd":"application/x-msschedule","scm":"application/vnd.lotus-screencam","scq":"application/scvp-cv-request","scs":"application/scvp-cv-response","scurl":"text/vnd.curl.scurl","sda":"application/vnd.stardivision.draw","sdc":"application/vnd.stardivision.calc","sdd":"application/vnd.stardivision.impress","sdkd":"application/vnd.solent.sdkm+xml","sdkm":"application/vnd.solent.sdkm+xml","sdp":"application/sdp","sdw":"application/vnd.stardivision.writer","see":"application/vnd.seemail","seed":"application/vnd.fdsn.seed","sema":"application/vnd.sema","semd":"application/vnd.semd","semf":"application/vnd.semf","ser":"application/java-serialized-object","setpay":"application/set-payment-initiation","setreg":"application/set-registration-initiation","sfd-hdstx":"application/vnd.hydrostatix.sof-data","sfs":"application/vnd.spotfire.sfs","sgl":"application/vnd.stardivision.writer-global","sgm":"text/sgml","sgml":"text/sgml","sh":"application/x-sh","shar":"application/x-shar","shf":"application/shf+xml","sig":"application/pgp-signature","silo":"model/mesh","sis":"application/vnd.symbian.install","sisx":"application/vnd.symbian.install","sit":"application/x-stuffit","sitx":"application/x-stuffitx","skd":"application/vnd.koan","skm":"application/vnd.koan","skp":"application/vnd.koan","skt":"application/vnd.koan","sldm":"application/vnd.ms-powerpoint.slide.macroenabled.12","sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide","slt":"application/vnd.epson.salt","smf":"application/vnd.stardivision.math","smi":"application/smil+xml","smil":"application/smil+xml","snd":"audio/basic","snf":"application/x-font-snf","so":"application/octet-stream","spc":"application/x-pkcs7-certificates","spf":"application/vnd.yamaha.smaf-phrase","spl":"application/x-futuresplash","spot":"text/vnd.in3d.spot","spp":"application/scvp-vp-response","spq":"application/scvp-vp-request","spx":"audio/ogg","src":"application/x-wais-source","srx":"application/sparql-results+xml","sse":"application/vnd.kodak-descriptor","ssf":"application/vnd.epson.ssf","ssml":"application/ssml+xml","stc":"application/vnd.sun.xml.calc.template","std":"application/vnd.sun.xml.draw.template","stf":"application/vnd.wt.stf","sti":"application/vnd.sun.xml.impress.template","stk":"application/hyperstudio","stl":"application/vnd.ms-pki.stl","str":"application/vnd.pg.format","stw":"application/vnd.sun.xml.writer.template","sus":"application/vnd.sus-calendar","susp":"application/vnd.sus-calendar","sv4cpio":"application/x-sv4cpio","sv4crc":"application/x-sv4crc","svd":"application/vnd.svd","svg":"image/svg+xml","svgz":"image/svg+xml","swa":"application/x-director","swf":"application/x-shockwave-flash","swi":"application/vnd.arastra.swi","sxc":"application/vnd.sun.xml.calc","sxd":"application/vnd.sun.xml.draw","sxg":"application/vnd.sun.xml.writer.global","sxi":"application/vnd.sun.xml.impress","sxm":"application/vnd.sun.xml.math","sxw":"application/vnd.sun.xml.writer","t":"text/troff","tao":"application/vnd.tao.intent-module-archive","tar":"application/x-tar","tcap":"application/vnd.3gpp2.tcap","tcl":"application/x-tcl","teacher":"application/vnd.smart.teacher","tex":"application/x-tex","texi":"application/x-texinfo","texinfo":"application/x-texinfo","text":"text/plain","tfm":"application/x-tex-tfm","tif":"image/tiff","tiff":"image/tiff","tmo":"application/vnd.tmobile-livetv","torrent":"application/x-bittorrent","tpl":"application/vnd.groove-tool-template","tpt":"application/vnd.trid.tpt","tr":"text/troff","tra":"application/vnd.trueapp","trm":"application/x-msterminal","tsv":"text/tab-separated-values","ttc":"application/x-font-ttf","ttf":"application/x-font-ttf","twd":"application/vnd.simtech-mindmapper","twds":"application/vnd.simtech-mindmapper","txd":"application/vnd.genomatix.tuxedo","txf":"application/vnd.mobius.txf","txt":"text/plain","u32":"application/x-authorware-bin","udeb":"application/x-debian-package","ufd":"application/vnd.ufdl","ufdl":"application/vnd.ufdl","umj":"application/vnd.umajin","unityweb":"application/vnd.unity","uoml":"application/vnd.uoml+xml","uri":"text/uri-list","uris":"text/uri-list","urls":"text/uri-list","ustar":"application/x-ustar","utz":"application/vnd.uiq.theme","uu":"text/x-uuencode","vcd":"application/x-cdlink","vcf":"text/x-vcard","vcg":"application/vnd.groove-vcard","vcs":"text/x-vcalendar","vcx":"application/vnd.vcx","vis":"application/vnd.visionary","viv":"video/vnd.vivo","vor":"application/vnd.stardivision.writer","vox":"application/x-authorware-bin","vrml":"model/vrml","vsd":"application/vnd.visio","vsf":"application/vnd.vsf","vss":"application/vnd.visio","vst":"application/vnd.visio","vsw":"application/vnd.visio","vtu":"model/vnd.vtu","vxml":"application/voicexml+xml","w3d":"application/x-director","wad":"application/x-doom","wav":"audio/x-wav","wax":"audio/x-ms-wax","wbmp":"image/vnd.wap.wbmp","wbs":"application/vnd.criticaltools.wbs+xml","wbxml":"application/vnd.wap.wbxml","wcm":"application/vnd.ms-works","wdb":"application/vnd.ms-works","wks":"application/vnd.ms-works","wm":"video/x-ms-wm","wma":"audio/x-ms-wma","wmd":"application/x-ms-wmd","wmf":"application/x-msmetafile","wml":"text/vnd.wap.wml","wmlc":"application/vnd.wap.wmlc","wmls":"text/vnd.wap.wmlscript","wmlsc":"application/vnd.wap.wmlscriptc","wmv":"video/x-ms-wmv","wmx":"video/x-ms-wmx","wmz":"application/x-ms-wmz","wpd":"application/vnd.wordperfect","wpl":"application/vnd.ms-wpl","wps":"application/vnd.ms-works","wqd":"application/vnd.wqd","wri":"application/x-mswrite","wrl":"model/vrml","wsdl":"application/wsdl+xml","wspolicy":"application/wspolicy+xml","wtb":"application/vnd.webturbo","wvx":"video/x-ms-wvx","x32":"application/x-authorware-bin","x3d":"application/vnd.hzn-3d-crossword","xap":"application/x-silverlight-app","xar":"application/vnd.xara","xbap":"application/x-ms-xbap","xbd":"application/vnd.fujixerox.docuworks.binder","xbm":"image/x-xbitmap","xdm":"application/vnd.syncml.dm+xml","xdp":"application/vnd.adobe.xdp+xml","xdw":"application/vnd.fujixerox.docuworks","xenc":"application/xenc+xml","xer":"application/patch-ops-error+xml","xfdf":"application/vnd.adobe.xfdf","xfdl":"application/vnd.xfdl","xht":"application/xhtml+xml","xhtml":"application/xhtml+xml","xhvml":"application/xv+xml","xif":"image/vnd.xiff","xla":"application/vnd.ms-excel","xlam":"application/vnd.ms-excel.addin.macroenabled.12","xlc":"application/vnd.ms-excel","xlm":"application/vnd.ms-excel","xls":"application/vnd.ms-excel","xlsb":"application/vnd.ms-excel.sheet.binary.macroenabled.12","xlsm":"application/vnd.ms-excel.sheet.macroenabled.12","xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","xlt":"application/vnd.ms-excel","xltm":"application/vnd.ms-excel.template.macroenabled.12","xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template","xlw":"application/vnd.ms-excel","xml":"application/xml","xo":"application/vnd.olpc-sugar","xop":"application/xop+xml","xpi":"application/x-xpinstall","xpm":"image/x-xpixmap","xpr":"application/vnd.is-xpr","xps":"application/vnd.ms-xpsdocument","xpw":"application/vnd.intercon.formnet","xpx":"application/vnd.intercon.formnet","xsl":"application/xml","xslt":"application/xslt+xml","xsm":"application/vnd.syncml+xml","xspf":"application/xspf+xml","xul":"application/vnd.mozilla.xul+xml","xvm":"application/xv+xml","xvml":"application/xv+xml","xwd":"image/x-xwindowdump","xyz":"chemical/x-xyz","zaz":"application/vnd.zzazz.deck+xml","zip":"application/zip","zir":"application/vnd.zul","zirz":"application/vnd.zul","zmm":"application/vnd.handheld-entertainment+xml"};F.Folder=function(path){this.path='';if(F.isString(path)){this.setPath(path);}};F.Folder.prototype={fso:function(){return F.fso();},setPath:function(path){this.path=(path.indexOf(':')>-1)?path:Server.MapPath(path);return this;},getPath:function(){return this.path;},getName:function(){return this.fso().GetFolder(this.path).Name;},exist:function(path){return this.fso().FolderExists(path||this.path);},getInfo:function(){var f=this.fso().GetFolder(this.path);var fso=this.fso(),path=this.path;return{'AbsolutePathName':fso.GetAbsolutePathName(path),'DateCreated':new Date(f.DateCreated),'DateLastAccessed':new Date(f.DateLastAccessed),'DateLastModified':new Date(f.DateLastModified),'Drive':String(f.Drive),'IsRootFolder':Boolean(f.IsRootFolder),'Name':f.Name,'ParentFolder':String(f.ParentFolder),'Path':String(f.Path),'ShortName':f.ShortName,'ShortPath':f.ShortPath,'Size':f.Size,'Type':f.Type}},create:function(path){var ps=(this.path||path).split(':');var fs=ps[1].split(/\\|\//);var tmp=ps[0]+':';do{tmp+='\\'+fs.shift();if(!this.exist(tmp)){this.fso().CreateFolder(tmp);}}while(fs.length&&fs[0])
return this;},createFile:function(name,content){var f=new F.File(this.path+'/'+name);if(!f.exist()){f.create();if(content){f.setText(content);}}},remove:function(path){if(this.exist(path)){this.fso().DeleteFolder(this.path||path);}
return this;},empty:function(){this.folders().forEach(function(folder){folder.remove();});this.files().forEach(function(file){file.remove();});return this;},getFolderName:function(){return this.fso().GetFolder(this.path).Name;},rename:function(name){name=name.trim();if(name!==''&&this.getFolderName()!==name){var f=this.fso().GetFolder(this.path);f.Name=name;this.path=f.Path;}
return this;},map:function(enumForder,filter,fn){var res=[];var fo=this.fso().GetFolder(this.path);var fc=new Enumerator(enumForder(fo));if(filter instanceof RegExp){var re=filter;filter=function(f){return re.test(f);}}else if(F.isString(filter)||F.isNumber(filter)){var s=String(filter);filter=function(f){return f.indexOf(s)>-1;}}
if(typeof filter!=="function"){filter=function(){return true;}}
for(;!fc.atEnd();fc.moveNext()){var f=fc.item().Path;if(filter(f)){res.push(fn(f));}}
return res;},folders:function(filter){return this.map(function(forder){return forder.SubFolders;},filter,function(path){return new F.Folder(path);});},allFolders:function(filter){var res=[],fs=this.folders(filter),fn=arguments.callee;res=res.concat(fs);fs.forEach(function(forder){res=res.concat(fn.call(forder,filter));});return res;},files:function(filter){return this.map(function(forder){return forder.files;},filter,function(path){return new F.File(path);});},allFiles:function(filter){var res=[],fs=this.folders(),fn=arguments.callee;fs.forEach(function(folder){res=res.concat(folder.files(filter));});fs.forEach(function(forder){res=res.concat(fn.call(forder,filter));});return res;},dispose:function(){this.path=null;}};F.Model=function(tableName,connection){this.tableName=tableName;this.connection=connection;this._constraints=[null,null,this.tableName];this._primaryKey=null;this.fields=null;};F.Model.prototype={pk:function(){if(this._primaryKey){return this._primaryKey;}else{var rs=this.connection.getSchema(28,this._constraints);if(rs.Eof){return null;}else{this._primaryKey=rs('COLUMN_NAME').Value;return this._primaryKey;}}},fieldsType:function(){var r={};var rs=this.connection.getSchema(4,this._constraints);var name,type;var Type=F.Model.AdoDataType;while(!rs.Eof){type=rs('DATA_TYPE').Value;name=rs('COLUMN_NAME').Value;r[name]={type:type,desc:Type[type].name,base:Type[type].type,isNullable:Boolean(rs('IS_NULLABLE').Value),hasDefault:Boolean(rs('COLUMN_DEFAULT').Value),defaultValue:rs('COLUMN_DEFAULT').Value,flags:rs('COLUMN_FLAGS').Value,maxLength:rs('CHARACTER_MAXIMUM_LENGTH').Value,numPrecision:rs('NUMERIC_PRECISION').Value};rs.MoveNext();}
rs.Close();rs=null;return r;},getCreateSql:function(){var pk=this.pk();var fields=this.fieldsType();var sql=['CREATE TABLE '+this.tableName+'('];var conn=this.connection;for(var f in fields){var field=fields[f];var type=conn.getTypeString(field.type,field.flags);sql.push('['+f,'] '+type);if(String(field.maxLength)!=='null'&&field.maxLength>0){sql.push('('+field.maxLength+')');}
if(pk===f){sql.push(' PRIMARY KEY');}
if(!field.isNullable){sql.push(' NOT NULL');}
sql.push(',');}
sql.pop();sql.push(');');return sql.join('');},count:function(where){where=this._getWhereString(where);var sql='select count(*) from '+this.tableName+where;return this.connection.executeScalar(sql);},page:function(page,where,fields,count,order,linkopt){var p={},where=this._getWhereString(where);pk=this.pk(),count=count||10,fields=fields||'*',order=' order by '+(order?order:pk),currentPage=parseInt(page||1);var linkCount=count||10;linkopt=linkopt||{};var params=linkopt.params;var pt=typeof params;if(pt==='string'){if(pt.charAt(0)==='&')
params=params.slice(0);}else if(pt==='object'){var ptemp=[];for(var i in params){ptemp.push(i+'='+params[i]);}
params=ptemp.join('&');}
if(params===undefined){params='';}else{params='&'+params;}
var sql='select * from '+this.tableName+where+order;var rs=this.connection.getRecordSet(sql);var total=rs.RecordCount;var totalPage=Math.ceil(total/count);if(isNaN(currentPage)||currentPage<1){currentPage=1;}else if(currentPage>totalPage){currentPage=totalPage;}
rs.PageSize=count;if(rs.PageCount<page){page=rs.PageCount;}
var data=[],index=0;var l=rs.Fields.Count;var fieldsName=[];for(var i=0;i<l;i++){fieldsName.push(rs.Fields(i).Name);}
if(rs.PageCount>0){rs.AbsolutePage=page;while(index<count&&!rs.Eof){var row={};for(var i=0;i<l;i++){row[fieldsName[i]]=rs(fieldsName[i]).Value;}
data.push(row);rs.MoveNext();index++;}}
var numbers=[],half=Math.ceil(linkCount/2),i=0,maxNum=(currentPage+half)<totalPage?currentPage+half:totalPage;while(i++<linkCount){if(maxNum>0){numbers.unshift(maxNum);}
maxNum--;}
var links=[];if(totalPage>0){if(currentPage===1){links.push('<li class="prev disabled"><a href="#">首页</a></li>');links.push('<li class="disabled"><a href="#">« 上页</a></li>');}else{links.push('<li><a href="?page=1'+params+'">首页</a></li>');links.push('<li><a href="?page='+(currentPage-1)+params+'">« 上页</a></li>');}
numbers.forEach(function(v,i){if(v===currentPage){links.push('<li class="active"><a href="#">',v,'</a></li>');}else{links.push('<li><a href="?page=',v,params,'">',v,'</a></li>');}});if(currentPage===totalPage){links.push('<li class="disabled"><a href="#">下页 »</a></li>');links.push('<li class="next disabled"><a href="#">尾页</a></li>');}else{links.push('<li><a href="?page=',(currentPage+1),params,'">下页 »</a></li>');links.push('<li class="next"><a href="?page=',totalPage,params,'">尾页</a></li>');}}
var r={'total':totalPage,'current':currentPage,'count':count,'isFirst':currentPage===1,'isLast':currentPage===total,'hasPrev':currentPage>1,'hasNext':currentPage<totalPage,'data':data,'numbers':numbers,'links':links.join('')};return r;},findAll:function(where,fields,order,limit,isRecordSet){where=this._getWhereString(where);fields=fields||'*';order=order?' order by '+order:'';limit=isNaN(parseInt(limit))?'':'top '+limit+' ';var sql='select '+limit+fields+' from '+this.tableName+where+order;var rs=this.connection.execute(sql);return isRecordSet?rs:this.connection.getJson(sql);},find:function(where,fields,order){var r=this.findAll(where,fields,order,1);return r.length==1?r[0]:null;},insert:function(values){this.connection.insert(this.tableName,values);},update:function(where,values){var sql='select * from '+this.tableName+this._getWhereString(where);this.connection.update(sql,values);},del:function(where){var sql='delete from '+this.tableName+this._getWhereString(where);this.connection.execute(sql);},html:function(where,fields,order,limit,opt){return this.connection.getHtmlTable(this.findAll(where,fields,order,limit,1),opt);},exportXml:function(fileName){var file=new F.File(fileName);var step=50,i=0;var fields=this.fieldsType();var rs=this.findAll('','*','','',true);var xml=['<',this.tableName,'>\n'];if(!file.exist()){file.create();}
while(!rs.Eof){i++;xml.push('\t<item>\n');for(var i in fields){xml.push('\t\t<',i,'><![CDATA[',String(rs(i).Value),']]></',i,'>\n');}
xml.push('\t</item>\n');if(i%step===0){file.appendText(xml.join(''));xml=[];}
rs.MoveNext();}
rs.Close();rs=null;xml.push('</',this.tableName,'>\n');file.appendText(xml.join(''));},exportSql:function(fileName){var file=new F.File(fileName);var step=50,i=0;var fields=this.fieldsType();var rs=this.findAll('','*','','',true);var createSql=this.getCreateSql();if(!file.exist()){file.create();}
file.appendText(createSql+'\n');var sql=[];while(!rs.Eof){i++;sql.push('insert into ',this.tableName,'(');var keys=[];var values=[];for(var i in fields){if(rs(i).Value===null){continue;}
keys.push('['+i+']');if(fields[i].base==='number'||fields[i].base==='boolean'){values.push(rs(i).Value||0);}else{values.push("'"+String(rs(i).Value).replace(/\r?\n/g,'__RN__').replace(/'/g,"''")+"'");}}
sql.push(keys.join(','),') values(');sql.push(values.join(','),');\n');if(i%step===0){file.appendText(sql.join(''));sql=[];}
rs.MoveNext();}
rs.Close();rs=null;file.appendText(sql.join(''));},_getWhereString:function(where){if(where===undefined||where===null){where='';}else if(F.isArray(where)){where=where.join(' and ');}else if(F.isNumber(where)){where=this.pk()+'='+where;}else if(F.isObject(where)){if(!this.fields){this.fields=this.fieldsType();}
var w='',fields=this.fields;for(var col in where){if(col in fields){var s=String(where[col]);w+='and '+col+'=';if(fields[col].base==='text'){w+="'"+s.replace(/'/g,"''")+"'";}else{w+=s;}}}
where=w.slice(4);}
return where===''?'':' where '+where;}};F.Model.BaseType={'unknown':0,'number':1,'date':2,'boolean':3,'text':4};F.Model.AdoDataType={0:{name:"adEmpty",type:'unknown'},10:{name:"adError",type:'unknown'},11:{name:"adBoolean",type:'boolean'},128:{name:"adBinary",type:'unknown'},129:{name:"adChar",type:'text'},12:{name:"adVariant",type:'unknown'},130:{name:"adWChar",type:'text'},131:{name:"adNumeric",type:'number'},132:{name:"adUserDefined",type:'unknown'},133:{name:"adDBDate",type:'date'},134:{name:"adDBTime",type:'date'},135:{name:"adDBTimeStamp",type:'date'},136:{name:"adChapter",type:'unknown'},137:{name:"adDBFileTime",type:'date'},138:{name:"adPropVariant",type:'unknown'},139:{name:"adVarNumeric",type:'number'},13:{name:"adIUnknown",type:'unknown'},14:{name:"adDecimal",type:'number'},16:{name:"adTinyInt",type:'number'},17:{name:"adUnsignedTinyInt",type:'number'},18:{name:"adUnsignedSmallInt",type:'number'},19:{name:"adUnsignedInt",type:'number'},200:{name:"adVarChar",type:'text'},201:{name:"adLongVarChar",type:'text'},202:{name:"adVarWChar",type:'text'},203:{name:"adLongVarWChar",type:'text'},204:{name:"adVarBinary",type:'unknown'},205:{name:"adLongVarBinary",type:'unknown'},20:{name:"adBigInt",type:'number'},21:{name:"adUnsignedBigInt",type:'number'},2:{name:"adSmallInt",type:'number'},3:{name:"adInteger",type:'number'},4:{name:"adSingle",type:'number'},5:{name:"adDouble",type:'number'},64:{name:"adFileTime",type:'date'},6:{name:"adCurrency",type:'number'},72:{name:"adGUID",type:'unknown'},7:{name:"adDate",type:'date'},8192:{name:"adArray",type:'unknown'},8:{name:"adBSTR",type:'unknown'},9:{name:"adIDispatch",type:'unknown'}};F.Upload=function(){if(!F.isPost())throw new Error("Not Post Method!");this.totalBytes=Request.TotalBytes;this.files=[];this.hash={};this._stream=new ActiveXObject("ADODB.Stream");this._tempStream=new ActiveXObject("ADODB.Stream");this.read();};F.Upload.prototype={read:function(){var s=this._stream;var t=this._tempStream;s.Type=1;s.Mode=3;s.Open();s.Write(Request.BinaryRead(this.totalBytes));s.Position=0;s.Type=2;s.Charset='ASCII';var content=s.readText(-1),head=content.substring(0,content.indexOf('\r\n')),headLen=head.length,headList=[],separator='\r\n\r\n';var pos=0;while(pos!=-1){headList.push({start:pos+headLen,len:content.indexOf(separator,pos)-headLen-pos});pos=content.indexOf(head,pos+1);}
content=null;var regInfo=/name="([^'"]+)";\s*filename="([^'"]+)"\s*Content-Type:\s*([^\s]+)/i;var files=this.files,hash=this.hash;for(var i=0;i<headList.length;i++){if(headList[i].len<1){continue;}
var temp=this.readHead(headList[i].start,headList[i].len);var info=regInfo.exec(temp);if(info&&info.length>0){var f={fieldName:info[1],fileName:info[2],extensionName:info[2].match(/\.(\w+)$/)[1],baseName:info[2].replace(/\.\w+$/,''),contentType:info[3],dataPosition:headList[i].start+headList[i].len+4,dataSize:headList[i+1].start-headList[i].start-headList[i].len-headLen-6};files.push(f);hash[info[1]]=f;}}},readHead:function(start,len){var s=this._stream;var t=this._tempStream;var text;t.Type=1;try{t.Open();s.Position=start;s.CopyTo(t,len);t.Position=0;t.Type=2;t.Charset="utf-8";text=t.readText(-1);}catch(e){throw e;}finally{t.close();}
return text;},getHash:function(){return this.hash;},getFiles:function(){return this.files;},getFile:function(name){if(F.isNumber(name)){return this.files[name];}
return this.hash[name];},saveToFile:function(name,path){var f=this.getFile(name);if(path===undefined){path=f.fileName;}
if(path.indexOf(':')===-1){path=Server.MapPath(path);}
var folder=new F.Folder(path.replace(/(\\|\/)[^\\\/]+$/,''));if(!folder.exist()){folder.create();}
var s=this._stream;var t=this._tempStream;t.Type=1;t.Open();s.Position=0;s.Position=f.dataPosition;s.CopyTo(t,f.dataSize);t.SaveToFile(path,2);t.Close();},saveAllTo:function(folder){var path=folder.indexOf(':')===-1?Server.MapPath(folder):folder;var last=path.slice(-1);path=(last==='/'||last==='\\')?path:path+'/';var folder=new F.Folder(path);if(!folder.exist()){folder.create();}
for(var i=0;i<this.files.length;i++){this.saveToFile(i,path+this.files[i].fileName);}},dispose:function(){if(this._stream.State!==0){this._stream.Close();this._stream=null;}
if(this._tempStream.State!==0){this._tempStream.Close();this._stream=null;}}};F.User=function(id,connection){this.id=null;this.name=null;this.password=null;this.group=F.User.GROUP.GUEST;this.config=F.User.config;this._allInfo=null;if(!F.User.connection){F.User.connection=connection||F.Connection.last;F.User.model=F.User.connection.model(this.config.tableName);}
if(id!==undefined){this.getById(id);}};F.User.connection=null;F.User.model=null;F.User.prototype={isGuest:function(){return this.group===F.User.GROUP.GUEST;},isMember:function(){return this.group>F.User.GROUP.GUEST;},isAdmin:function(){return this.group===F.User.GROUP.ADMIN;},getById:function(id){return this.getBy('id',id);},getByName:function(name){return this.getBy('name',name);},getBy:function(key,value){if(F.isString(value)){value=String(value).trim();}
if(value===undefined||value==''||value=='*')
return this;var info=this.getInfoBy(key,value);if(info){this._allInfo=info;this.id=info[this.config['id']];this.name=info[this.config['name']];this.password=info[this.config['password']];this.group=info[this.config['group']];}
return this;},getInfoBy:function(key,value){var w={};w[this.config[key]]=value;return F.User.model.find(w);},existId:function(id){return!!this.getInfoBy('id',id);},existName:function(name){return!!this.getInfoBy('name',name);},check:function(name,password,isMd5){var info=this.getInfoBy('name',name);if(info){if(isMd5){password=F.md5(password);}
if(info[this.config.password]===password){return true;}}
return false;},checkLogin:function(name,password,isMd5){name=name.trim().replace(/\s/g,'').replace(/[,"'.*%-+&<>=]+/g,'');password=password.replace(/\W/g,'');if(this.check(name,password,isMd5)){Session.CodePage=65001;Session.LCID=2052;Session.Timeout=60;F.session.set('F_User_login_ok',1);return true;}
return false;},logout:function(){F.User.logout();},isLogin:function(){return F.User.isLogin();}};F.User.isLogin=function(){return!!F.session.get('F_User_login_ok');};F.User.logout=function(){F.session.remove('f_user_login_ok');}
F.User.GROUP={'GUEST':0,'MEMBER':1,'ADMIN':100};F.User.config={'tableName':'users','id':'id','name':'user_name','group':'user_group','password':'user_password'};F.Xml=function(input){this.input=input;this.xml=null;this.obj=null;if(F.isObject(input)){this.obj=input;this.xml=input.xml;}else if(F.isString(input)){this.xml=input;this.obj=F.Xml.parseXMLString(input);}};F.Xml.prototype={toJson:function(node){return F.Xml.parseXMLNode(node||this.obj);},load:function(url){var _this=this;F.ajax.get(url,function(xml){_this.obj=xml;_this.xml=xml.xml;},'xml');return _this;},toString:function(){return this.xml;}};F.Xml.parseXMLNode=function(node){var obj={};var element=node.firstChild;while(element){if(element.nodeType===1){var name=element.nodeName;var sub=F.Xml.parseXMLNode(element)
sub.nodeValue="";sub.xml=element.xml;sub.toString=function(){return this.nodeValue;};sub.toXMLString=function(){return this.xml;}
if(element.attributes){for(var i=0;i<element.attributes.length;i++){var attribute=element.attributes[i];sub[attribute.nodeName]=attribute.nodeValue;}}
if(element.firstChild){var nodeType=element.firstChild.nodeType;if(nodeType===3||nodeType===4){sub.nodeValue=element.firstChild.nodeValue;}}
if(obj[name]){if(!obj[name].length){var temp=obj[name];obj[name]=[];obj[name].push(temp);}
obj[name].push(sub);}else{obj[name]=sub;}}
element=element.nextSibling;}
return obj;};F.Xml.parseXMLString=function(xml){var obj={};var xmlDOM=new ActiveXObject("Microsoft.XMLDOM");xmlDOM.async=false;xmlDOM.validateOnParse=false;if(xml.trim().indexOf('<?xml')!==0){xml='<__root>'+xml+'</__root>';}
var success=xmlDOM.loadXML(xml);if(success){obj=xmlDOM.documentElement;}
xmlDOM=null;return obj;};function JSZip(compression)
{this.compression=(compression||"STORE").toUpperCase();this.files=[];this.root="";this.d={base64:false,binary:false,dir:false,date:null};if(!JSZip.compressions[this.compression]){throw compression+" is not a valid compression method !";}}
JSZip.prototype.add=function(name,data,o)
{o=o||{};name=this.root+name;if(o.base64===true&&o.binary==null)o.binary=true;for(var opt in this.d)
{o[opt]=o[opt]||this.d[opt];}
o.date=o.date||new Date();var dosTime,dosDate;dosTime=o.date.getHours();dosTime=dosTime<<6;dosTime=dosTime|o.date.getMinutes();dosTime=dosTime<<5;dosTime=dosTime|o.date.getSeconds()/2;dosDate=o.date.getFullYear()-1980;dosDate=dosDate<<4;dosDate=dosDate|(o.date.getMonth()+1);dosDate=dosDate<<5;dosDate=dosDate|o.date.getDate();if(o.base64===true)data=JSZipBase64.decode(data);if(o.binary===false)data=this.utf8encode(data);var compression=JSZip.compressions[this.compression];var compressedData=compression.compress(data);var header="";header+="\x0A\x00";header+="\x00\x00";header+=compression.magic;header+=this.decToHex(dosTime,2);header+=this.decToHex(dosDate,2);header+=this.decToHex(this.crc32(data),4);header+=this.decToHex(compressedData.length,4);header+=this.decToHex(data.length,4);header+=this.decToHex(name.length,2);header+="\x00\x00";this.files[name]={header:header,data:compressedData,dir:o.dir};return this;};JSZip.prototype.folder=function(name)
{if(name.substr(-1)!="/")name+="/";if(typeof this.files[name]==="undefined")this.add(name,'',{dir:true});var ret=this.clone();ret.root=this.root+name;return ret;};JSZip.prototype.find=function(needle)
{var result=[],re;if(typeof needle==="string")
{re=new RegExp("^"+needle+"$");}
else
{re=needle;}
for(var filename in this.files)
{if(re.test(filename))
{var file=this.files[filename];result.push({name:filename,data:file.data,dir:!!file.dir});}}
return result;};JSZip.prototype.remove=function(name)
{var file=this.files[name];if(!file)
{if(name.substr(-1)!="/")name+="/";file=this.files[name];}
if(file)
{if(name.match("/")===null)
{delete this.files[name];}
else
{var kids=this.find(new RegExp("^"+name));for(var i=0;i<kids.length;i++)
{if(kids[i].name==name)
{delete this.files[name];}
else
{this.remove(kids[i].name);}}}}
return this;};JSZip.prototype.generate=function(asBytes)
{asBytes=asBytes||false;var directory=[],files=[],fileOffset=0;for(var name in this.files)
{if(!this.files.hasOwnProperty(name)){continue;}
var fileRecord="",dirRecord="";fileRecord="\x50\x4b\x03\x04"+this.files[name].header+name+this.files[name].data;dirRecord="\x50\x4b\x01\x02"+"\x14\x00"+
this.files[name].header+"\x00\x00"+"\x00\x00"+"\x00\x00"+
(this.files[name].dir===true?"\x10\x00\x00\x00":"\x00\x00\x00\x00")+
this.decToHex(fileOffset,4)+
name;fileOffset+=fileRecord.length;files.push(fileRecord);directory.push(dirRecord);}
var fileData=files.join("");var dirData=directory.join("");var dirEnd="";dirEnd="\x50\x4b\x05\x06"+"\x00\x00"+"\x00\x00"+
this.decToHex(files.length,2)+
this.decToHex(files.length,2)+
this.decToHex(dirData.length,4)+
this.decToHex(fileData.length,4)+"\x00\x00";var zip=fileData+dirData+dirEnd;return(asBytes)?zip:JSZipBase64.encode(zip);};JSZip.compressions={"STORE":{magic:"\x00\x00",compress:function(content){return content;}}};JSZip.prototype.decToHex=function(dec,bytes)
{var hex="";for(var i=0;i<bytes;i++){hex+=String.fromCharCode(dec&0xff);dec=dec>>>8;}
return hex;};JSZip.prototype.crc32=function(str,crc)
{if(str==="")return"\x00\x00\x00\x00";var table="00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D";if(typeof(crc)=="undefined"){crc=0;}
var x=0;var y=0;crc=crc^(-1);for(var i=0,iTop=str.length;i<iTop;i++){y=(crc^str.charCodeAt(i))&0xFF;x="0x"+table.substr(y*9,8);crc=(crc>>>8)^x;}
return crc^(-1);};JSZip.prototype.clone=function()
{var newObj=new JSZip();for(var i in this)
{if(typeof this[i]!=="function")
{newObj[i]=this[i];}}
return newObj;};JSZip.prototype.utf8encode=function(input)
{input=encodeURIComponent(input);input=input.replace(/%.{2,2}/g,function(m){var hex=m.substring(1);return String.fromCharCode(parseInt(hex,16));});return input;};var JSZipBase64=function(){var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(input,utf8){var output="";var chr1,chr2,chr3,enc1,enc2,enc3,enc4;var i=0;while(i<input.length){chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64;}else if(isNaN(chr3)){enc4=64;}
output=output+
_keyStr.charAt(enc1)+_keyStr.charAt(enc2)+
_keyStr.charAt(enc3)+_keyStr.charAt(enc4);}
return output;},decode:function(input,utf8){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(i<input.length){enc1=_keyStr.indexOf(input.charAt(i++));enc2=_keyStr.indexOf(input.charAt(i++));enc3=_keyStr.indexOf(input.charAt(i++));enc4=_keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2);}
if(enc4!=64){output=output+String.fromCharCode(chr3);}}
return output;}};}();if(!JSZip)
{throw"JSZip not defined";}
(function(){var zip_WSIZE=32768;var zip_STORED_BLOCK=0;var zip_STATIC_TREES=1;var zip_DYN_TREES=2;var zip_DEFAULT_LEVEL=6;var zip_FULL_SEARCH=true;var zip_INBUFSIZ=32768;var zip_INBUF_EXTRA=64;var zip_OUTBUFSIZ=1024*8;var zip_window_size=2*zip_WSIZE;var zip_MIN_MATCH=3;var zip_MAX_MATCH=258;var zip_BITS=16;var zip_LIT_BUFSIZE=0x2000;var zip_HASH_BITS=13;if(zip_LIT_BUFSIZE>zip_INBUFSIZ)
alert("error: zip_INBUFSIZ is too small");if((zip_WSIZE<<1)>(1<<zip_BITS))
alert("error: zip_WSIZE is too large");if(zip_HASH_BITS>zip_BITS-1)
alert("error: zip_HASH_BITS is too large");if(zip_HASH_BITS<8||zip_MAX_MATCH!=258)
alert("error: Code too clever");var zip_DIST_BUFSIZE=zip_LIT_BUFSIZE;var zip_HASH_SIZE=1<<zip_HASH_BITS;var zip_HASH_MASK=zip_HASH_SIZE-1;var zip_WMASK=zip_WSIZE-1;var zip_NIL=0;var zip_TOO_FAR=4096;var zip_MIN_LOOKAHEAD=zip_MAX_MATCH+zip_MIN_MATCH+1;var zip_MAX_DIST=zip_WSIZE-zip_MIN_LOOKAHEAD;var zip_SMALLEST=1;var zip_MAX_BITS=15;var zip_MAX_BL_BITS=7;var zip_LENGTH_CODES=29;var zip_LITERALS=256;var zip_END_BLOCK=256;var zip_L_CODES=zip_LITERALS+1+zip_LENGTH_CODES;var zip_D_CODES=30;var zip_BL_CODES=19;var zip_REP_3_6=16;var zip_REPZ_3_10=17;var zip_REPZ_11_138=18;var zip_HEAP_SIZE=2*zip_L_CODES+1;var zip_H_SHIFT=parseInt((zip_HASH_BITS+zip_MIN_MATCH-1)/zip_MIN_MATCH);var zip_free_queue;var zip_qhead,zip_qtail;var zip_initflag;var zip_outbuf=null;var zip_outcnt,zip_outoff;var zip_complete;var zip_window;var zip_d_buf;var zip_l_buf;var zip_prev;var zip_bi_buf;var zip_bi_valid;var zip_block_start;var zip_ins_h;var zip_hash_head;var zip_prev_match;var zip_match_available;var zip_match_length;var zip_prev_length;var zip_strstart;var zip_match_start;var zip_eofile;var zip_lookahead;var zip_max_chain_length;var zip_max_lazy_match;var zip_compr_level;var zip_good_match;var zip_nice_match;var zip_dyn_ltree;var zip_dyn_dtree;var zip_static_ltree;var zip_static_dtree;var zip_bl_tree;var zip_l_desc;var zip_d_desc;var zip_bl_desc;var zip_bl_count;var zip_heap;var zip_heap_len;var zip_heap_max;var zip_depth;var zip_length_code;var zip_dist_code;var zip_base_length;var zip_base_dist;var zip_flag_buf;var zip_last_lit;var zip_last_dist;var zip_last_flags;var zip_flags;var zip_flag_bit;var zip_opt_len;var zip_static_len;var zip_deflate_data;var zip_deflate_pos;var zip_DeflateCT=function(){this.fc=0;this.dl=0;}
var zip_DeflateTreeDesc=function(){this.dyn_tree=null;this.static_tree=null;this.extra_bits=null;this.extra_base=0;this.elems=0;this.max_length=0;this.max_code=0;}
var zip_DeflateConfiguration=function(a,b,c,d){this.good_length=a;this.max_lazy=b;this.nice_length=c;this.max_chain=d;}
var zip_DeflateBuffer=function(){this.next=null;this.len=0;this.ptr=new Array(zip_OUTBUFSIZ);this.off=0;}
var zip_extra_lbits=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0);var zip_extra_dbits=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13);var zip_extra_blbits=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7);var zip_bl_order=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15);var zip_configuration_table=new Array(new zip_DeflateConfiguration(0,0,0,0),new zip_DeflateConfiguration(4,4,8,4),new zip_DeflateConfiguration(4,5,16,8),new zip_DeflateConfiguration(4,6,32,32),new zip_DeflateConfiguration(4,4,16,16),new zip_DeflateConfiguration(8,16,32,32),new zip_DeflateConfiguration(8,16,128,128),new zip_DeflateConfiguration(8,32,128,256),new zip_DeflateConfiguration(32,128,258,1024),new zip_DeflateConfiguration(32,258,258,4096));var zip_deflate_start=function(level){var i;if(!level)
level=zip_DEFAULT_LEVEL;else if(level<1)
level=1;else if(level>9)
level=9;zip_compr_level=level;zip_initflag=false;zip_eofile=false;if(zip_outbuf!=null)
return;zip_free_queue=zip_qhead=zip_qtail=null;zip_outbuf=new Array(zip_OUTBUFSIZ);zip_window=new Array(zip_window_size);zip_d_buf=new Array(zip_DIST_BUFSIZE);zip_l_buf=new Array(zip_INBUFSIZ+zip_INBUF_EXTRA);zip_prev=new Array(1<<zip_BITS);zip_dyn_ltree=new Array(zip_HEAP_SIZE);for(i=0;i<zip_HEAP_SIZE;i++)
zip_dyn_ltree[i]=new zip_DeflateCT();zip_dyn_dtree=new Array(2*zip_D_CODES+1);for(i=0;i<2*zip_D_CODES+1;i++)
zip_dyn_dtree[i]=new zip_DeflateCT();zip_static_ltree=new Array(zip_L_CODES+2);for(i=0;i<zip_L_CODES+2;i++)
zip_static_ltree[i]=new zip_DeflateCT();zip_static_dtree=new Array(zip_D_CODES);for(i=0;i<zip_D_CODES;i++)
zip_static_dtree[i]=new zip_DeflateCT();zip_bl_tree=new Array(2*zip_BL_CODES+1);for(i=0;i<2*zip_BL_CODES+1;i++)
zip_bl_tree[i]=new zip_DeflateCT();zip_l_desc=new zip_DeflateTreeDesc();zip_d_desc=new zip_DeflateTreeDesc();zip_bl_desc=new zip_DeflateTreeDesc();zip_bl_count=new Array(zip_MAX_BITS+1);zip_heap=new Array(2*zip_L_CODES+1);zip_depth=new Array(2*zip_L_CODES+1);zip_length_code=new Array(zip_MAX_MATCH-zip_MIN_MATCH+1);zip_dist_code=new Array(512);zip_base_length=new Array(zip_LENGTH_CODES);zip_base_dist=new Array(zip_D_CODES);zip_flag_buf=new Array(parseInt(zip_LIT_BUFSIZE/8));}
var zip_deflate_end=function(){zip_free_queue=zip_qhead=zip_qtail=null;zip_outbuf=null;zip_window=null;zip_d_buf=null;zip_l_buf=null;zip_prev=null;zip_dyn_ltree=null;zip_dyn_dtree=null;zip_static_ltree=null;zip_static_dtree=null;zip_bl_tree=null;zip_l_desc=null;zip_d_desc=null;zip_bl_desc=null;zip_bl_count=null;zip_heap=null;zip_depth=null;zip_length_code=null;zip_dist_code=null;zip_base_length=null;zip_base_dist=null;zip_flag_buf=null;}
var zip_reuse_queue=function(p){p.next=zip_free_queue;zip_free_queue=p;}
var zip_new_queue=function(){var p;if(zip_free_queue!=null)
{p=zip_free_queue;zip_free_queue=zip_free_queue.next;}
else
p=new zip_DeflateBuffer();p.next=null;p.len=p.off=0;return p;}
var zip_head1=function(i){return zip_prev[zip_WSIZE+i];}
var zip_head2=function(i,val){return zip_prev[zip_WSIZE+i]=val;}
var zip_put_byte=function(c){zip_outbuf[zip_outoff+zip_outcnt++]=c;if(zip_outoff+zip_outcnt==zip_OUTBUFSIZ)
zip_qoutbuf();}
var zip_put_short=function(w){w&=0xffff;if(zip_outoff+zip_outcnt<zip_OUTBUFSIZ-2){zip_outbuf[zip_outoff+zip_outcnt++]=(w&0xff);zip_outbuf[zip_outoff+zip_outcnt++]=(w>>>8);}else{zip_put_byte(w&0xff);zip_put_byte(w>>>8);}}
var zip_INSERT_STRING=function(){zip_ins_h=((zip_ins_h<<zip_H_SHIFT)^(zip_window[zip_strstart+zip_MIN_MATCH-1]&0xff))&zip_HASH_MASK;zip_hash_head=zip_head1(zip_ins_h);zip_prev[zip_strstart&zip_WMASK]=zip_hash_head;zip_head2(zip_ins_h,zip_strstart);}
var zip_SEND_CODE=function(c,tree){zip_send_bits(tree[c].fc,tree[c].dl);}
var zip_D_CODE=function(dist){return(dist<256?zip_dist_code[dist]:zip_dist_code[256+(dist>>7)])&0xff;}
var zip_SMALLER=function(tree,n,m){return tree[n].fc<tree[m].fc||(tree[n].fc==tree[m].fc&&zip_depth[n]<=zip_depth[m]);}
var zip_read_buff=function(buff,offset,n){var i;for(i=0;i<n&&zip_deflate_pos<zip_deflate_data.length;i++)
buff[offset+i]=zip_deflate_data.charCodeAt(zip_deflate_pos++)&0xff;return i;}
var zip_lm_init=function(){var j;for(j=0;j<zip_HASH_SIZE;j++)
zip_prev[zip_WSIZE+j]=0;zip_max_lazy_match=zip_configuration_table[zip_compr_level].max_lazy;zip_good_match=zip_configuration_table[zip_compr_level].good_length;if(!zip_FULL_SEARCH)
zip_nice_match=zip_configuration_table[zip_compr_level].nice_length;zip_max_chain_length=zip_configuration_table[zip_compr_level].max_chain;zip_strstart=0;zip_block_start=0;zip_lookahead=zip_read_buff(zip_window,0,2*zip_WSIZE);if(zip_lookahead<=0){zip_eofile=true;zip_lookahead=0;return;}
zip_eofile=false;while(zip_lookahead<zip_MIN_LOOKAHEAD&&!zip_eofile)
zip_fill_window();zip_ins_h=0;for(j=0;j<zip_MIN_MATCH-1;j++){zip_ins_h=((zip_ins_h<<zip_H_SHIFT)^(zip_window[j]&0xff))&zip_HASH_MASK;}}
var zip_longest_match=function(cur_match){var chain_length=zip_max_chain_length;var scanp=zip_strstart;var matchp;var len;var best_len=zip_prev_length;var limit=(zip_strstart>zip_MAX_DIST?zip_strstart-zip_MAX_DIST:zip_NIL);var strendp=zip_strstart+zip_MAX_MATCH;var scan_end1=zip_window[scanp+best_len-1];var scan_end=zip_window[scanp+best_len];if(zip_prev_length>=zip_good_match)
chain_length>>=2;do{matchp=cur_match;if(zip_window[matchp+best_len]!=scan_end||zip_window[matchp+best_len-1]!=scan_end1||zip_window[matchp]!=zip_window[scanp]||zip_window[++matchp]!=zip_window[scanp+1]){continue;}
scanp+=2;matchp++;do{}while(zip_window[++scanp]==zip_window[++matchp]&&zip_window[++scanp]==zip_window[++matchp]&&zip_window[++scanp]==zip_window[++matchp]&&zip_window[++scanp]==zip_window[++matchp]&&zip_window[++scanp]==zip_window[++matchp]&&zip_window[++scanp]==zip_window[++matchp]&&zip_window[++scanp]==zip_window[++matchp]&&zip_window[++scanp]==zip_window[++matchp]&&scanp<strendp);len=zip_MAX_MATCH-(strendp-scanp);scanp=strendp-zip_MAX_MATCH;if(len>best_len){zip_match_start=cur_match;best_len=len;if(zip_FULL_SEARCH){if(len>=zip_MAX_MATCH)break;}else{if(len>=zip_nice_match)break;}
scan_end1=zip_window[scanp+best_len-1];scan_end=zip_window[scanp+best_len];}}while((cur_match=zip_prev[cur_match&zip_WMASK])>limit&&--chain_length!=0);return best_len;}
var zip_fill_window=function(){var n,m;var more=zip_window_size-zip_lookahead-zip_strstart;if(more==-1){more--;}else if(zip_strstart>=zip_WSIZE+zip_MAX_DIST){for(n=0;n<zip_WSIZE;n++)
zip_window[n]=zip_window[n+zip_WSIZE];zip_match_start-=zip_WSIZE;zip_strstart-=zip_WSIZE;zip_block_start-=zip_WSIZE;for(n=0;n<zip_HASH_SIZE;n++){m=zip_head1(n);zip_head2(n,m>=zip_WSIZE?m-zip_WSIZE:zip_NIL);}
for(n=0;n<zip_WSIZE;n++){m=zip_prev[n];zip_prev[n]=(m>=zip_WSIZE?m-zip_WSIZE:zip_NIL);}
more+=zip_WSIZE;}
if(!zip_eofile){n=zip_read_buff(zip_window,zip_strstart+zip_lookahead,more);if(n<=0)
zip_eofile=true;else
zip_lookahead+=n;}}
var zip_deflate_fast=function(){while(zip_lookahead!=0&&zip_qhead==null){var flush;zip_INSERT_STRING();if(zip_hash_head!=zip_NIL&&zip_strstart-zip_hash_head<=zip_MAX_DIST){zip_match_length=zip_longest_match(zip_hash_head);if(zip_match_length>zip_lookahead)
zip_match_length=zip_lookahead;}
if(zip_match_length>=zip_MIN_MATCH){flush=zip_ct_tally(zip_strstart-zip_match_start,zip_match_length-zip_MIN_MATCH);zip_lookahead-=zip_match_length;if(zip_match_length<=zip_max_lazy_match){zip_match_length--;do{zip_strstart++;zip_INSERT_STRING();}while(--zip_match_length!=0);zip_strstart++;}else{zip_strstart+=zip_match_length;zip_match_length=0;zip_ins_h=zip_window[zip_strstart]&0xff;zip_ins_h=((zip_ins_h<<zip_H_SHIFT)^(zip_window[zip_strstart+1]&0xff))&zip_HASH_MASK;}}else{flush=zip_ct_tally(0,zip_window[zip_strstart]&0xff);zip_lookahead--;zip_strstart++;}
if(flush){zip_flush_block(0);zip_block_start=zip_strstart;}
while(zip_lookahead<zip_MIN_LOOKAHEAD&&!zip_eofile)
zip_fill_window();}}
var zip_deflate_better=function(){while(zip_lookahead!=0&&zip_qhead==null){zip_INSERT_STRING();zip_prev_length=zip_match_length;zip_prev_match=zip_match_start;zip_match_length=zip_MIN_MATCH-1;if(zip_hash_head!=zip_NIL&&zip_prev_length<zip_max_lazy_match&&zip_strstart-zip_hash_head<=zip_MAX_DIST){zip_match_length=zip_longest_match(zip_hash_head);if(zip_match_length>zip_lookahead)
zip_match_length=zip_lookahead;if(zip_match_length==zip_MIN_MATCH&&zip_strstart-zip_match_start>zip_TOO_FAR){zip_match_length--;}}
if(zip_prev_length>=zip_MIN_MATCH&&zip_match_length<=zip_prev_length){var flush;flush=zip_ct_tally(zip_strstart-1-zip_prev_match,zip_prev_length-zip_MIN_MATCH);zip_lookahead-=zip_prev_length-1;zip_prev_length-=2;do{zip_strstart++;zip_INSERT_STRING();}while(--zip_prev_length!=0);zip_match_available=0;zip_match_length=zip_MIN_MATCH-1;zip_strstart++;if(flush){zip_flush_block(0);zip_block_start=zip_strstart;}}else if(zip_match_available!=0){if(zip_ct_tally(0,zip_window[zip_strstart-1]&0xff)){zip_flush_block(0);zip_block_start=zip_strstart;}
zip_strstart++;zip_lookahead--;}else{zip_match_available=1;zip_strstart++;zip_lookahead--;}
while(zip_lookahead<zip_MIN_LOOKAHEAD&&!zip_eofile)
zip_fill_window();}}
var zip_init_deflate=function(){if(zip_eofile)
return;zip_bi_buf=0;zip_bi_valid=0;zip_ct_init();zip_lm_init();zip_qhead=null;zip_outcnt=0;zip_outoff=0;if(zip_compr_level<=3)
{zip_prev_length=zip_MIN_MATCH-1;zip_match_length=0;}
else
{zip_match_length=zip_MIN_MATCH-1;zip_match_available=0;}
zip_complete=false;}
var zip_deflate_internal=function(buff,off,buff_size){var n;if(!zip_initflag)
{zip_init_deflate();zip_initflag=true;if(zip_lookahead==0){zip_complete=true;return 0;}}
if((n=zip_qcopy(buff,off,buff_size))==buff_size)
return buff_size;if(zip_complete)
return n;if(zip_compr_level<=3)
zip_deflate_fast();else
zip_deflate_better();if(zip_lookahead==0){if(zip_match_available!=0)
zip_ct_tally(0,zip_window[zip_strstart-1]&0xff);zip_flush_block(1);zip_complete=true;}
return n+zip_qcopy(buff,n+off,buff_size-n);}
var zip_qcopy=function(buff,off,buff_size){var n,i,j;n=0;while(zip_qhead!=null&&n<buff_size)
{i=buff_size-n;if(i>zip_qhead.len)
i=zip_qhead.len;for(j=0;j<i;j++)
buff[off+n+j]=zip_qhead.ptr[zip_qhead.off+j];zip_qhead.off+=i;zip_qhead.len-=i;n+=i;if(zip_qhead.len==0){var p;p=zip_qhead;zip_qhead=zip_qhead.next;zip_reuse_queue(p);}}
if(n==buff_size)
return n;if(zip_outoff<zip_outcnt){i=buff_size-n;if(i>zip_outcnt-zip_outoff)
i=zip_outcnt-zip_outoff;for(j=0;j<i;j++)
buff[off+n+j]=zip_outbuf[zip_outoff+j];zip_outoff+=i;n+=i;if(zip_outcnt==zip_outoff)
zip_outcnt=zip_outoff=0;}
return n;}
var zip_ct_init=function(){var n;var bits;var length;var code;var dist;if(zip_static_dtree[0].dl!=0)return;zip_l_desc.dyn_tree=zip_dyn_ltree;zip_l_desc.static_tree=zip_static_ltree;zip_l_desc.extra_bits=zip_extra_lbits;zip_l_desc.extra_base=zip_LITERALS+1;zip_l_desc.elems=zip_L_CODES;zip_l_desc.max_length=zip_MAX_BITS;zip_l_desc.max_code=0;zip_d_desc.dyn_tree=zip_dyn_dtree;zip_d_desc.static_tree=zip_static_dtree;zip_d_desc.extra_bits=zip_extra_dbits;zip_d_desc.extra_base=0;zip_d_desc.elems=zip_D_CODES;zip_d_desc.max_length=zip_MAX_BITS;zip_d_desc.max_code=0;zip_bl_desc.dyn_tree=zip_bl_tree;zip_bl_desc.static_tree=null;zip_bl_desc.extra_bits=zip_extra_blbits;zip_bl_desc.extra_base=0;zip_bl_desc.elems=zip_BL_CODES;zip_bl_desc.max_length=zip_MAX_BL_BITS;zip_bl_desc.max_code=0;length=0;for(code=0;code<zip_LENGTH_CODES-1;code++){zip_base_length[code]=length;for(n=0;n<(1<<zip_extra_lbits[code]);n++)
zip_length_code[length++]=code;}
zip_length_code[length-1]=code;dist=0;for(code=0;code<16;code++){zip_base_dist[code]=dist;for(n=0;n<(1<<zip_extra_dbits[code]);n++){zip_dist_code[dist++]=code;}}
dist>>=7;for(;code<zip_D_CODES;code++){zip_base_dist[code]=dist<<7;for(n=0;n<(1<<(zip_extra_dbits[code]-7));n++)
zip_dist_code[256+dist++]=code;}
for(bits=0;bits<=zip_MAX_BITS;bits++)
zip_bl_count[bits]=0;n=0;while(n<=143){zip_static_ltree[n++].dl=8;zip_bl_count[8]++;}
while(n<=255){zip_static_ltree[n++].dl=9;zip_bl_count[9]++;}
while(n<=279){zip_static_ltree[n++].dl=7;zip_bl_count[7]++;}
while(n<=287){zip_static_ltree[n++].dl=8;zip_bl_count[8]++;}
zip_gen_codes(zip_static_ltree,zip_L_CODES+1);for(n=0;n<zip_D_CODES;n++){zip_static_dtree[n].dl=5;zip_static_dtree[n].fc=zip_bi_reverse(n,5);}
zip_init_block();}
var zip_init_block=function(){var n;for(n=0;n<zip_L_CODES;n++)zip_dyn_ltree[n].fc=0;for(n=0;n<zip_D_CODES;n++)zip_dyn_dtree[n].fc=0;for(n=0;n<zip_BL_CODES;n++)zip_bl_tree[n].fc=0;zip_dyn_ltree[zip_END_BLOCK].fc=1;zip_opt_len=zip_static_len=0;zip_last_lit=zip_last_dist=zip_last_flags=0;zip_flags=0;zip_flag_bit=1;}
var zip_pqdownheap=function(tree,k){var v=zip_heap[k];var j=k<<1;while(j<=zip_heap_len){if(j<zip_heap_len&&zip_SMALLER(tree,zip_heap[j+1],zip_heap[j]))
j++;if(zip_SMALLER(tree,v,zip_heap[j]))
break;zip_heap[k]=zip_heap[j];k=j;j<<=1;}
zip_heap[k]=v;}
var zip_gen_bitlen=function(desc){var tree=desc.dyn_tree;var extra=desc.extra_bits;var base=desc.extra_base;var max_code=desc.max_code;var max_length=desc.max_length;var stree=desc.static_tree;var h;var n,m;var bits;var xbits;var f;var overflow=0;for(bits=0;bits<=zip_MAX_BITS;bits++)
zip_bl_count[bits]=0;tree[zip_heap[zip_heap_max]].dl=0;for(h=zip_heap_max+1;h<zip_HEAP_SIZE;h++){n=zip_heap[h];bits=tree[tree[n].dl].dl+1;if(bits>max_length){bits=max_length;overflow++;}
tree[n].dl=bits;if(n>max_code)
continue;zip_bl_count[bits]++;xbits=0;if(n>=base)
xbits=extra[n-base];f=tree[n].fc;zip_opt_len+=f*(bits+xbits);if(stree!=null)
zip_static_len+=f*(stree[n].dl+xbits);}
if(overflow==0)
return;do{bits=max_length-1;while(zip_bl_count[bits]==0)
bits--;zip_bl_count[bits]--;zip_bl_count[bits+1]+=2;zip_bl_count[max_length]--;overflow-=2;}while(overflow>0);for(bits=max_length;bits!=0;bits--){n=zip_bl_count[bits];while(n!=0){m=zip_heap[--h];if(m>max_code)
continue;if(tree[m].dl!=bits){zip_opt_len+=(bits-tree[m].dl)*tree[m].fc;tree[m].fc=bits;}
n--;}}}
var zip_gen_codes=function(tree,max_code){var next_code=new Array(zip_MAX_BITS+1);var code=0;var bits;var n;for(bits=1;bits<=zip_MAX_BITS;bits++){code=((code+zip_bl_count[bits-1])<<1);next_code[bits]=code;}
for(n=0;n<=max_code;n++){var len=tree[n].dl;if(len==0)
continue;tree[n].fc=zip_bi_reverse(next_code[len]++,len);}}
var zip_build_tree=function(desc){var tree=desc.dyn_tree;var stree=desc.static_tree;var elems=desc.elems;var n,m;var max_code=-1;var node=elems;zip_heap_len=0;zip_heap_max=zip_HEAP_SIZE;for(n=0;n<elems;n++){if(tree[n].fc!=0){zip_heap[++zip_heap_len]=max_code=n;zip_depth[n]=0;}else
tree[n].dl=0;}
while(zip_heap_len<2){var xnew=zip_heap[++zip_heap_len]=(max_code<2?++max_code:0);tree[xnew].fc=1;zip_depth[xnew]=0;zip_opt_len--;if(stree!=null)
zip_static_len-=stree[xnew].dl;}
desc.max_code=max_code;for(n=zip_heap_len>>1;n>=1;n--)
zip_pqdownheap(tree,n);do{n=zip_heap[zip_SMALLEST];zip_heap[zip_SMALLEST]=zip_heap[zip_heap_len--];zip_pqdownheap(tree,zip_SMALLEST);m=zip_heap[zip_SMALLEST];zip_heap[--zip_heap_max]=n;zip_heap[--zip_heap_max]=m;tree[node].fc=tree[n].fc+tree[m].fc;if(zip_depth[n]>zip_depth[m]+1)
zip_depth[node]=zip_depth[n];else
zip_depth[node]=zip_depth[m]+1;tree[n].dl=tree[m].dl=node;zip_heap[zip_SMALLEST]=node++;zip_pqdownheap(tree,zip_SMALLEST);}while(zip_heap_len>=2);zip_heap[--zip_heap_max]=zip_heap[zip_SMALLEST];zip_gen_bitlen(desc);zip_gen_codes(tree,max_code);}
var zip_scan_tree=function(tree,max_code){var n;var prevlen=-1;var curlen;var nextlen=tree[0].dl;var count=0;var max_count=7;var min_count=4;if(nextlen==0){max_count=138;min_count=3;}
tree[max_code+1].dl=0xffff;for(n=0;n<=max_code;n++){curlen=nextlen;nextlen=tree[n+1].dl;if(++count<max_count&&curlen==nextlen)
continue;else if(count<min_count)
zip_bl_tree[curlen].fc+=count;else if(curlen!=0){if(curlen!=prevlen)
zip_bl_tree[curlen].fc++;zip_bl_tree[zip_REP_3_6].fc++;}else if(count<=10)
zip_bl_tree[zip_REPZ_3_10].fc++;else
zip_bl_tree[zip_REPZ_11_138].fc++;count=0;prevlen=curlen;if(nextlen==0){max_count=138;min_count=3;}else if(curlen==nextlen){max_count=6;min_count=3;}else{max_count=7;min_count=4;}}}
var zip_send_tree=function(tree,max_code){var n;var prevlen=-1;var curlen;var nextlen=tree[0].dl;var count=0;var max_count=7;var min_count=4;if(nextlen==0){max_count=138;min_count=3;}
for(n=0;n<=max_code;n++){curlen=nextlen;nextlen=tree[n+1].dl;if(++count<max_count&&curlen==nextlen){continue;}else if(count<min_count){do{zip_SEND_CODE(curlen,zip_bl_tree);}while(--count!=0);}else if(curlen!=0){if(curlen!=prevlen){zip_SEND_CODE(curlen,zip_bl_tree);count--;}
zip_SEND_CODE(zip_REP_3_6,zip_bl_tree);zip_send_bits(count-3,2);}else if(count<=10){zip_SEND_CODE(zip_REPZ_3_10,zip_bl_tree);zip_send_bits(count-3,3);}else{zip_SEND_CODE(zip_REPZ_11_138,zip_bl_tree);zip_send_bits(count-11,7);}
count=0;prevlen=curlen;if(nextlen==0){max_count=138;min_count=3;}else if(curlen==nextlen){max_count=6;min_count=3;}else{max_count=7;min_count=4;}}}
var zip_build_bl_tree=function(){var max_blindex;zip_scan_tree(zip_dyn_ltree,zip_l_desc.max_code);zip_scan_tree(zip_dyn_dtree,zip_d_desc.max_code);zip_build_tree(zip_bl_desc);for(max_blindex=zip_BL_CODES-1;max_blindex>=3;max_blindex--){if(zip_bl_tree[zip_bl_order[max_blindex]].dl!=0)break;}
zip_opt_len+=3*(max_blindex+1)+5+5+4;return max_blindex;}
var zip_send_all_trees=function(lcodes,dcodes,blcodes){var rank;zip_send_bits(lcodes-257,5);zip_send_bits(dcodes-1,5);zip_send_bits(blcodes-4,4);for(rank=0;rank<blcodes;rank++){zip_send_bits(zip_bl_tree[zip_bl_order[rank]].dl,3);}
zip_send_tree(zip_dyn_ltree,lcodes-1);zip_send_tree(zip_dyn_dtree,dcodes-1);}
var zip_flush_block=function(eof){var opt_lenb,static_lenb;var max_blindex;var stored_len;stored_len=zip_strstart-zip_block_start;zip_flag_buf[zip_last_flags]=zip_flags;zip_build_tree(zip_l_desc);zip_build_tree(zip_d_desc);max_blindex=zip_build_bl_tree();opt_lenb=(zip_opt_len+3+7)>>3;static_lenb=(zip_static_len+3+7)>>3;if(static_lenb<=opt_lenb)
opt_lenb=static_lenb;if(stored_len+4<=opt_lenb&&zip_block_start>=0){var i;zip_send_bits((zip_STORED_BLOCK<<1)+eof,3);zip_bi_windup();zip_put_short(stored_len);zip_put_short(~stored_len);for(i=0;i<stored_len;i++)
zip_put_byte(zip_window[zip_block_start+i]);}else if(static_lenb==opt_lenb){zip_send_bits((zip_STATIC_TREES<<1)+eof,3);zip_compress_block(zip_static_ltree,zip_static_dtree);}else{zip_send_bits((zip_DYN_TREES<<1)+eof,3);zip_send_all_trees(zip_l_desc.max_code+1,zip_d_desc.max_code+1,max_blindex+1);zip_compress_block(zip_dyn_ltree,zip_dyn_dtree);}
zip_init_block();if(eof!=0)
zip_bi_windup();}
var zip_ct_tally=function(dist,lc){zip_l_buf[zip_last_lit++]=lc;if(dist==0){zip_dyn_ltree[lc].fc++;}else{dist--;zip_dyn_ltree[zip_length_code[lc]+zip_LITERALS+1].fc++;zip_dyn_dtree[zip_D_CODE(dist)].fc++;zip_d_buf[zip_last_dist++]=dist;zip_flags|=zip_flag_bit;}
zip_flag_bit<<=1;if((zip_last_lit&7)==0){zip_flag_buf[zip_last_flags++]=zip_flags;zip_flags=0;zip_flag_bit=1;}
if(zip_compr_level>2&&(zip_last_lit&0xfff)==0){var out_length=zip_last_lit*8;var in_length=zip_strstart-zip_block_start;var dcode;for(dcode=0;dcode<zip_D_CODES;dcode++){out_length+=zip_dyn_dtree[dcode].fc*(5+zip_extra_dbits[dcode]);}
out_length>>=3;if(zip_last_dist<parseInt(zip_last_lit/2)&&out_length<parseInt(in_length/2))
return true;}
return(zip_last_lit==zip_LIT_BUFSIZE-1||zip_last_dist==zip_DIST_BUFSIZE);}
var zip_compress_block=function(ltree,dtree){var dist;var lc;var lx=0;var dx=0;var fx=0;var flag=0;var code;var extra;if(zip_last_lit!=0)do{if((lx&7)==0)
flag=zip_flag_buf[fx++];lc=zip_l_buf[lx++]&0xff;if((flag&1)==0){zip_SEND_CODE(lc,ltree);}else{code=zip_length_code[lc];zip_SEND_CODE(code+zip_LITERALS+1,ltree);extra=zip_extra_lbits[code];if(extra!=0){lc-=zip_base_length[code];zip_send_bits(lc,extra);}
dist=zip_d_buf[dx++];code=zip_D_CODE(dist);zip_SEND_CODE(code,dtree);extra=zip_extra_dbits[code];if(extra!=0){dist-=zip_base_dist[code];zip_send_bits(dist,extra);}}
flag>>=1;}while(lx<zip_last_lit);zip_SEND_CODE(zip_END_BLOCK,ltree);}
var zip_Buf_size=16;var zip_send_bits=function(value,length){if(zip_bi_valid>zip_Buf_size-length){zip_bi_buf|=(value<<zip_bi_valid);zip_put_short(zip_bi_buf);zip_bi_buf=(value>>(zip_Buf_size-zip_bi_valid));zip_bi_valid+=length-zip_Buf_size;}else{zip_bi_buf|=value<<zip_bi_valid;zip_bi_valid+=length;}}
var zip_bi_reverse=function(code,len){var res=0;do{res|=code&1;code>>=1;res<<=1;}while(--len>0);return res>>1;}
var zip_bi_windup=function(){if(zip_bi_valid>8){zip_put_short(zip_bi_buf);}else if(zip_bi_valid>0){zip_put_byte(zip_bi_buf);}
zip_bi_buf=0;zip_bi_valid=0;}
var zip_qoutbuf=function(){if(zip_outcnt!=0){var q,i;q=zip_new_queue();if(zip_qhead==null)
zip_qhead=zip_qtail=q;else
zip_qtail=zip_qtail.next=q;q.len=zip_outcnt-zip_outoff;for(i=0;i<q.len;i++)
q.ptr[i]=zip_outbuf[zip_outoff+i];zip_outcnt=zip_outoff=0;}}
var zip_deflate=function(str,level){var i,j;zip_deflate_data=str;zip_deflate_pos=0;if(typeof level=="undefined")
level=zip_DEFAULT_LEVEL;zip_deflate_start(level);var buff=new Array(1024);var aout=[];while((i=zip_deflate_internal(buff,0,buff.length))>0){var cbuf=new Array(i);for(j=0;j<i;j++){cbuf[j]=String.fromCharCode(buff[j]);}
aout[aout.length]=cbuf.join("");}
zip_deflate_data=null;return aout.join("");}
JSZip.compressions["DEFLATE"]={magic:"\x08\x00",compress:function(content){return zip_deflate(content);}}})();F.Zip=function(){this.zip=new JSZip('DEFLATE');};F.Zip.prototype={add:function(name,data,options){return this.zip.add(name,data,options);},folder:function(name){return this.zip.folder(name);},find:function(needle){return this.zip.find(needle);},remove:function(name){return this.zip.remove(name);},generate:function(asBytes){return this.zip.generate(asBytes);},addFile:function(path){var file=new F.File(path);return this.add(path,file.getBase64String(),{base64:true});},saveToFile:function(name){var content=this.generate();var file=new F.File(name);file.setBase64String(content);}};Response.Charset="utf8";var echo=function(){for(var i=0,l=arguments.length;i<l;i++){if(typeof arguments[i]==='object'){Response.Write(F.json.stringify(arguments[i]));}else{Response.Write(arguments[i]);}}};var die=function(){echo.apply(this,arguments);Response.End();};var log=function(s){echo('<pre style="background:#eee;padding:3px;margin:3px 0;font-size:12px;">',F.encodeHTML(F.formatJSON(F.json.stringify({DATA:arguments.length>0?s:__template_data}).slice(8,-1))),'</pre>');Response.Flush();};var __template_data={"page_title":"标题"};var assign=function(key,value){__template_data[key]=value;};var display=function(tpl,data){var html=F.fetch(tpl,data||__template_data,{checkFile:false});echo(html);return html;};var error=function(msg){};var debug=function(a,e){if(arguments.length===1){e=a;a=debug;}
if(DEBUG_MODE){var err;if(e instanceof Error){err=e;}else{err=new Error();var s=Array.prototype.slice.call(arguments,1);for(var i=0;i<s.length;i++){err['message'+i]=s[i]}}
var msg='';msg+=('<div style="color:#d00;"><b>DEBUG:</b>');msg+=('<pre>'+F.encodeHTML(a.callee.toString())+'</pre>');msg+=F.json.stringify(err);msg+=('</div>');error(msg);}else{error();}};var bind=function(ctrl,actions){if(typeof ctrl==='object'){actions=ctrl;ctrl="site";}
var controllers=F._controllers||(F._controllers={});var controller=controllers[ctrl]||(controllers[ctrl]={});F.extend(controller,actions);};var getController=function(ctrl){return F._controllers[ctrl];};var run=function(){var controllers=F._controllers||(F._controllers={});var ctrl=F.get('r')||'site';var action=F.get('a')||'index';var fn=function(){if('_init'in controllers[ctrl]){controllers[ctrl]._init();}
controllers[ctrl][action]();};if(ctrl in controllers){if(action in controllers[ctrl]&&action.substring(0,1)!=='_'){if(DEBUG_MODE){fn();}else{try{fn();}catch(e){error('抱歉，出错了。信息：'+e.message);}}}else{error('您要查看的页面被禁止访问');}}else{error('未知的控制参数');}};bind('site',{index:function(){assign('name','Tom');display('bin/template/index.html');}});run();%>